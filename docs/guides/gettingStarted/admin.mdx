---
title: 'ç®¡ç†åå°åŠç›‘æ§ç³»ç»Ÿ'
sidebar_position: 6
---




# ç®¡ç†åå° ğŸ–¥ï¸
### ğŸŸ¢ å¼€æ”¾ç«¯å£

| TCP ç«¯å£  | è¯´æ˜                    | æ“ä½œ âš™ï¸                                      |
|:--------:|:-----------------------:|:--------------------------------------------:|
| TCP:11002| `http://ip:11002` è®¿é—®ç®¡ç†åå° | ç«¯å£æ”¾è¡Œæˆ– nginx åå‘ä»£ç†ï¼Œå¹¶å…³é—­é˜²ç«å¢™ |

## ğŸ“Œ è®¿é—®ç®¡ç†åå°

:::tip
åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ `http://ip:11002` æ¥è®¿é—®ç®¡ç†åå°ã€‚æ­¤ ip ä¸ºæœåŠ¡ç«¯ ip ï¼Œä¸”ç¡®ä¿æ‚¨çš„æµè§ˆå™¨èƒ½è®¿é—®ã€‚é»˜è®¤è´¦å·å’Œå¯†ç å‡ä¸ºadmin1
:::

import Image3 from './assets/admin.jpg';

<img src={Image3} width="700" alt="PC Web Interface" />
```





# ç›‘æ§ç³»ç»Ÿ
æœ¬æ–‡æ¡£ä»‹ç»äºŒè¿›åˆ¶&dockeræ–¹å¼éƒ¨ç½²openimçš„Prometheusç›‘æ§å’Œå‘Šè­¦åŠŸèƒ½çš„éƒ¨ç½²å’Œä½¿ç”¨,
k8sæ–¹å¼éƒ¨ç½²openimçš„ç›‘æ§å’Œå‘Šè­¦ä½¿ç”¨è¯·æŸ¥é˜…é“¾æ¥æ–‡æ¡£:https://github.com/openimsdk/helm-charts/blob/main/docs/user-guide-zh.md

## äºŒè¿›åˆ¶éƒ¨ç½²openim-serveræ–¹å¼çš„ç›‘æ§éƒ¨ç½²
å¦‚ä¸‹æ˜¯äºŒè¿›åˆ¶æ–¹å¼éƒ¨ç½²openim-serverçš„æ­¥éª¤æµç¨‹ï¼š
æ­¥éª¤1ï¼šClone the repository and switch to the release branch
            git clone https://github.com/openimsdk/open-im-server && cd open-im-server
æ­¥éª¤2ï¼šSet common environment variables.
æ­¥éª¤3ï¼šDeploy components.
            make init && docker compose up -d.
æˆ‘ä»¬è¦å¼€å¯ç›‘æ§åŠŸèƒ½ï¼Œéœ€è¦åœ¨å°†æ­¥éª¤3åˆ†è§£ä¸‰ä¸ªå°æ­¥:3.1ï¼Œ3.2ï¼Œ3.3
æ­¥éª¤3.1ï¼šæ‰§è¡Œmake initå‘½ä»¤ï¼Œå°†ç”Ÿæˆå‡ºçš„config/config.yamlæ–‡ä»¶æ‰“å¼€ï¼Œä¿®æ”¹å¦‚ä¸‹prometheus.enable: true
:::tip
å¦‚éœ€é…ç½®å‘Šè­¦åŠŸèƒ½ï¼Œè¯·åœ¨æ­¤æ­¥éª¤æ”¹å†™alertmanager.ymlï¼Œemail.tmplï¼Œinstance-down-rules.ymlè¯·æŸ¥é˜… å‘Šè­¦ç³»ç»Ÿ>å‘Šè­¦é…ç½®æ–‡ä»¶è¯´æ˜.ä¸ºä½“éªŒçš„æ–¹ä¾¿ï¼Œå¯å…ˆä¸æ”¹å†™ä¸‰é…ç½®æ–‡ä»¶ã€‚
:::
import Image40 from './assets/config1.png';
<img src={Image40} width="700" alt="PC Web Interface" />
```
æ­¥éª¤3.2ï¼šä¿®æ”¹docker-compose.ymlæ–‡ä»¶ï¼ŒæŠŠopenim-adminç®¡ç†åå°æ¨¡å—å’Œç›‘æ§å‘Šè­¦éœ€è¦çš„ç»„ä»¶:prometheus,grafana,alertmanager,node-exporter(å¯é€‰)å˜æˆå¯ç”¨ï¼Œ
               æŠŠå¯¹åº”æ¨¡å—çš„æ³¨é‡Šå»æ‰ï¼Œå¦‚å›¾
import Image4 from './assets/docker-compose1.png';
<img src={Image4} width="700" alt="PC Web Interface" />
```
import Image5 from './assets/docker-compose2.png';
<img src={Image5} width="700" alt="PC Web Interface" />
```
æ­¥éª¤3.3ï¼šæ‰§è¡Œdocker compose up -då®‰è£…æ‰€æœ‰ç›‘æ§ç»„ä»¶å’Œç®¡ç†åå°æ¨¡å—
:::tip
å› openim-adminç®¡ç†åå°æ¨¡å—ä½¿ç”¨åˆ°äº†chatæœåŠ¡æ¨¡å—ï¼Œæ‰€ä»¥ä½ è¿˜éœ€è¦å®‰è£…æˆ‘ä»¬é¢å¤–çš„chatæ¨¡å—ï¼Œ
å®‰è£…chatæ¨¡å—çš„æ–‡æ¡£è¯·æŸ¥é˜…Quick Start>Source Code Deployment>AppServer(chat)
:::
## dockeréƒ¨ç½²openim-serveræ–¹å¼çš„ç›‘æ§éƒ¨ç½²
å¦‚ä¸‹æ˜¯dockeréƒ¨ç½²openim-serverçš„æ­¥éª¤æµç¨‹ï¼š
æ­¥éª¤1ï¼šSet Common Environment Variables
æ­¥éª¤2ï¼šPull and Launch Image
            git clone https://github.com/openim-sigs/openim-docker openim/openim-docker && export openim=$(pwd)/openim && cd $openim/openim-docker && make init && docker compose up -d

æˆ‘ä»¬è¦å¼€å¯ç›‘æ§åŠŸèƒ½ï¼Œéœ€è¦å°†æ­¥éª¤2åˆ†è§£ä¸‰ä¸ªå°æ­¥ï¼š2.1ï¼Œ2.2ï¼Œ2.3
æ­¥éª¤2.1ï¼šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤
             git clone https://github.com/openim-sigs/openim-docker openim/openim-docker && export openim=$(pwd)/openim && cd $openim/openim-docker && make init
             å°†ç”Ÿæˆå‡ºçš„config/config.yamlæ–‡ä»¶æ‰“å¼€ï¼Œä¿®æ”¹å¦‚ä¸‹prometheus.enable: trueã€‚
:::tip
å¦‚éœ€é…ç½®å‘Šè­¦åŠŸèƒ½ï¼Œè¯·åœ¨æ­¤æ­¥éª¤æ”¹å†™alertmanager.ymlï¼Œemail.tmplï¼Œinstance-down-rules.ymlè¯·æŸ¥é˜… å‘Šè­¦ç³»ç»Ÿ>å‘Šè­¦é…ç½®æ–‡ä»¶è¯´æ˜.ä¸ºä½“éªŒçš„æ–¹ä¾¿ï¼Œå¯å…ˆä¸æ”¹å†™ä¸‰é…ç½®æ–‡ä»¶ã€‚
:::
import Image40 from './assets/config1.png';
<img src={Image40} width="700" alt="PC Web Interface" />
```
æ­¥éª¤2.2ï¼šä¿®æ”¹docker-compose.ymlæ–‡ä»¶ï¼ŒæŠŠç›‘æ§éœ€è¦çš„ç»„ä»¶ï¼šprometheus,grafana,alertmanager,node-exporter(å¯é€‰)å˜æˆå¯ç”¨ï¼Œ
               æŠŠå¯¹åº”æ¨¡å—çš„æ³¨é‡Šå»æ‰ï¼Œå¦‚å›¾
import Image4 from './assets/docker-compose1.png';
<img src={Image4} width="700" alt="PC Web Interface" />
```
import Image5 from './assets/docker-compose2.png';
<img src={Image5} width="700" alt="PC Web Interface" />
```
æ­¥éª¤3.3ï¼šæ‰§è¡Œdocker compose up -då®‰è£…æ‰€æœ‰ç›‘æ§ç»„ä»¶ã€‚
## k8sæ–¹å¼éƒ¨ç½²openim-server
k8séƒ¨ç½²openim-serverå’Œå¼€å¯ç›‘æ§åŠŸèƒ½è¯·æŸ¥é˜…æ–‡æ¡£ï¼šhttps://github.com/openimsdk/helm-charts/blob/main/README-zh_CN.md

## ä½“éªŒ
1. é€šè¿‡openimç®¡ç†åå°ç½‘é¡µçš„é“¾æ¥å…¥å£è®¿é—®,ç®¡ç†åå°ç½‘é¡µåœ°å€:https://ip:11002/
2. ç®¡ç†åå°é»˜è®¤ç”¨æˆ·åå’Œå¯†ç  (admin1:admin1),ç‚¹å‡»ä¸‹å›¾é“¾æ¥ï¼Œå°†æ‰“å¼€grafanaç½‘é¡µ.
import Image6 from './assets/admin1.png';
<img src={Image6} width="700" alt="PC Web Interface" />
```
3. ç™»å…¥grafanaä½¿ç”¨é»˜è®¤ç”¨æˆ·åå’Œå¯†ç (admin:admin).
import Image7 from './assets/login.png';
<img src={Image7} width="700" alt="PC Web Interface" />
```
4. æ·»åŠ Prometheusæ•°æ®æºï¼Œå¦‚ä¸‹å›¾ï¼Œè¾“å…¥Prometheusæ•°æ®æºçš„url:http://172.28.0.1:19090,ç‚¹å‡»"Save and Test"è¿›è¡Œæ•°æ®æºä¿å­˜.
import Image8 from './assets/database.png';
<img src={Image8} width="700" alt="PC Web Interface" />
```

import Image9 from './assets/database2.png';
<img src={Image9} width="700" alt="PC Web Interface" />
```
5. å¯¼å…¥dockerç‰ˆæœ¬openimè‡ªå®šä¹‰dashboardä»ªè¡¨ç›˜.ç‚¹å‡»ä¸‹å›¾çš„importæŒ‰é’®
import Image10 from './assets/dashboard.png';
<img src={Image10} width="700" alt="PC Web Interface" />
```

æ‹·è´ config/template/prometheus-dashboard.yamlå†…å®¹ åˆ°ä¸‹å›¾åŒºåŸŸ,æ¥ç€ç‚¹å‡»loadæŒ‰é’®
import Image11 from './assets/dashboard2.png';
<img src={Image11} width="700" alt="PC Web Interface" />
```
é€‰æ‹©ä½ çš„ Data Sourceå’Œjob ,ä½ å°†è¦æŸ¥çœ‹åˆ°è‡ªå®šä¹‰æŒ‡æ ‡ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾
import Image12 from './assets/dashboard3.png';
<img src={Image12} width="700" alt="PC Web Interface" />
```
6.å¯¼å…¥node-exportçš„å®˜ç½‘dashboardï¼Œç›´æ¥å®˜ç½‘(https://grafana.com/grafana/dashboards/)å¯»æ‰¾ä½ æ»¡æ„çš„node-exporter dashboardè¯•å›¾ï¼Œ
ç„¶åå¯¼å…¥ï¼Œæ¯”å¦‚ 1860(Node Exporter Full)
import Image13 from './assets/dashboard4.png';
<img src={Image13} width="700" alt="PC Web Interface" />
```

ä½ å°†è¦æŸ¥çœ‹åˆ°node-exporteræŒ‡æ ‡ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾
import Image14 from './assets/dashboard5.png';
<img src={Image14} width="700" alt="PC Web Interface" />
```
# å‘Šè­¦ç³»ç»Ÿ
ç³»ç»Ÿå®ç°äº†ä¸¤æ¡é»˜è®¤å‘Šè­¦è§„åˆ™(instance_down,database_insert_failure_alerts)é‚®ä»¶å‘Šè­¦ï¼Œ
åªéœ€è¦ä¿®æ”¹configæ–‡ä»¶å¤¹ä¸‹çš„alertmanager.ymlæ–‡ä»¶é‡Œé¢çš„å‘é€é‚®ç®±å’Œæ¥æ”¶é‚®ç®±çš„é…ç½®ä¿¡æ¯ï¼Œå³å¯æ¥æ”¶é»˜è®¤è§„åˆ™çš„ç³»ç»Ÿå‘Šè­¦é‚®ä»¶ã€‚
:::tip
å¦‚æœæƒ³å®ç°é’‰é’‰ï¼Œä¼ä¸šå¾®ä¿¡ç­‰æ–¹å¼çš„å‘Šè­¦é€šçŸ¥ï¼Œéœ€è¦è‡ªè¡Œæ”¹å†™alertmanager.ymlï¼Œ
å¯ä»¥å‚é˜…å‘Šè­¦ç®¡ç†æ¨¡å—å®˜æ–¹æ–‡æ¡£ï¼šhttps://prometheus.io/docs/alerting/latest/alertmanager/
:::
## å‘Šè­¦é…ç½®æ–‡ä»¶è¯´æ˜
1ï¼Œå‘Šè­¦ä¸‰é…ç½®æ–‡ä»¶è¯´æ˜ï¼Œæ•´ä¸ªå‘Šè­¦æœ‰ä¸‰ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯alertmanager.ymlï¼Œemail.tmplï¼Œinstance-down-rules.ymlï¼Œå¦‚ä¸‹å›¾:
import Image15 from './assets/alert1.png';
<img src={Image15} width="700" alt="PC Web Interface" />
```
2ï¼Œé‚®ä»¶å‘Šè­¦æ¶æ„è¯´æ˜å›¾,Prometheusç»„ä»¶åŠ è½½å‘Šè­¦è§„åˆ™instance-down-rules.ymlæ–‡ä»¶ï¼Œå°†ç¬¦åˆæ¡ä»¶çš„å‘Šè­¦ä¿¡æ¯å‘é€åˆ°alertmanagerç»„ä»¶ï¼Œ
alertmanagerç»„ä»¶åŠ è½½alertmanager.ymlå’Œemail.tmplæ–‡ä»¶ï¼Œé€šè¿‡é…ç½®çš„å‘Šè­¦é‚®ç®±ä¿¡æ¯å’Œé‚®ä»¶æ¨¡ç‰ˆå‘é€é‚®ä»¶
import Image16 from './assets/alert2.png';
<img src={Image16} width="700" alt="PC Web Interface" />
```
3ï¼Œå‘Šè­¦è§„åˆ™instance-down-rules.yamlæ–‡ä»¶è¯´æ˜ï¼Œå¦‚æœå¢åŠ å‘Šè­¦è§„åˆ™å¯ä»¥åœ¨instance-down-rules.ymlæ–‡ä»¶ä¸­æ·»åŠ è§„åˆ™:
import Image17 from './assets/alert3.png';
<img src={Image17} width="700" alt="PC Web Interface" />
```
4ï¼Œå‘Šè­¦ç®¡ç†alertmanager.ymlæ–‡ä»¶è¯´æ˜,è¯·ä¿®æ”¹æˆä½ çœŸå®çš„å‘é€é‚®ç®±å’Œæ¥æ”¶é‚®ç®±é…ç½®ä¿¡æ¯ï¼Œå³å¯æ¥æ”¶å‘Šè­¦ä¿¡æ¯:
import Image18 from './assets/alert4.png';
<img src={Image18} width="700" alt="PC Web Interface" />
```
5ï¼Œé‚®ä»¶æ¨¡ç‰ˆæ–‡ä»¶email.tmplè¯´æ˜ï¼Œæ­¤æ–‡ä»¶æ˜¯htmlæ ¼å¼ï¼Œå‘Šè­¦ç®¡ç†æ¨¡å—ä¼šå¡«å……é‡Œé¢çš„å˜é‡ä¿¡æ¯ï¼Œç„¶åæ¸²æŸ“æˆhtmlæ ¼å¼æ–‡ä»¶ï¼Œè¿›è¡Œé‚®ä»¶çš„å‘é€ï¼Œ
     ä½ å¯ä»¥è·Ÿç€è‡ªå·±çš„éœ€è¦è¿›è¡Œæ¨¡ç‰ˆæ–‡ä»¶çš„æ”¹å†™:
import Image19 from './assets/alert5.png';
<img src={Image19} width="700" alt="PC Web Interface" />
```
## å‘Šè­¦éƒ¨ç½²
å‘Šè­¦æ¨¡å—æ˜¯å’Œç›‘æ§æ¨¡å—ä¸€èµ·éƒ¨ç½²çš„ï¼Œä¸å­˜åœ¨å•ç‹¬éƒ¨ç½²å‘Šè­¦æ¨¡å—ã€‚
è¯·åœ¨éƒ¨ç½²ç›‘æ§æ­¥éª¤(ç›‘æ§ç³»ç»Ÿ>äºŒè¿›åˆ¶éƒ¨ç½²openim-serveræ–¹å¼çš„ç›‘æ§éƒ¨ç½²>æ­¥éª¤3.1;ç›‘æ§ç³»ç»Ÿ>dockeréƒ¨ç½²openim-serveræ–¹å¼çš„ç›‘æ§éƒ¨ç½²>æ­¥éª¤2.1)ä¸­æ ¹æ®éœ€è¦
æ”¹å†™alertmanager.ymlï¼Œemail.tmplï¼Œinstance-down-rules.ymlæ–‡ä»¶æˆä½ éœ€æ±‚å³å¯ï¼Œ
ä½“éªŒé˜¶æ®µåªéœ€è¦ä¿®æ”¹alertmanager.ymlæ–‡ä»¶é‡Œé¢çš„å‘é€é‚®ç®±å’Œæ¥æ”¶é‚®ç®±çš„é…ç½®ä¿¡æ¯ï¼Œå³å¯æ¥æ”¶é»˜è®¤è§„åˆ™çš„ç³»ç»Ÿå‘Šè­¦é‚®ä»¶ï¼Œå¿«é€Ÿä½“éªŒ.
## å‘Šè­¦ä½“éªŒ
å¯æ‰‹åŠ¨è§¦å‘instancedownå‘Šè­¦è§„åˆ™ï¼Œæ‰§è¡Œmake stopå‘½ä»¤åœæ­¢openim-serveræœåŠ¡ï¼Œç­‰å¾…5måˆ†é’Ÿä»¥ä¸Šï¼Œå³å¯æ”¶åˆ°å‘Šè­¦é‚®ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
import Image20 from './assets/alert6.png';
<img src={Image20} width="700" alt="PC Web Interface" />
```
# æ—¥å¿—ç³»ç»Ÿ
å¦‚æœæ˜¯åœ¨k8sç¯å¢ƒé€šè¿‡helm chartæ–¹å¼éƒ¨ç½²çš„openimæœåŠ¡ï¼Œå¯ä»¥é€šè¿‡grafanaæŸ¥çœ‹lokiæ—¥å¿—ï¼Œå³é€šè¿‡grafanaæŸ¥çœ‹openimæ‰€æœ‰æœåŠ¡çš„æ—¥å¿—ä¿¡æ¯ã€‚
ç›®å‰äºŒè¿›åˆ¶å’Œdockeréƒ¨ç½²æ²¡æœ‰é›†æˆlokiæ—¥å¿—æ”¶é›†ç»„ä»¶ï¼Œæƒ³ä½“éªŒlokiæ—¥å¿—æ”¶é›†åŠŸèƒ½ï¼Œè¯·é‡‡ç”¨helm chartéƒ¨ç½²ï¼Œ
è¯¦æƒ…è¯·æŸ¥é˜…é“¾æ¥https://github.com/openimsdk/helm-charts/blob/main/docs/user-guide-zh.md