"use strict";(self.webpackChunkopenim_docs=self.webpackChunkopenim_docs||[]).push([[5700],{3905:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>u});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var d=r.createContext({}),s=function(e){var n=r.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},l=function(e){var n=s(e.components);return r.createElement(d.Provider,{value:n},e.children)},c="mdxType",_={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,d=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),c=s(t),m=a,u=c["".concat(d,".").concat(m)]||c[m]||_[m]||o;return t?r.createElement(u,i(i({ref:n},l),{},{components:t})):r.createElement(u,i({ref:n},l))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=m;var p={};for(var d in n)hasOwnProperty.call(n,d)&&(p[d]=n[d]);p.originalType=e,p[c]="string"==typeof e?e:a,i[1]=p;for(var s=2;s<o;s++)i[s]=t[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},53918:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>p,metadata:()=>s,toc:()=>c});t(67294);var r=t(3905);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}const p={title:"\u57df\u540d\u53caSSL\u8bc1\u4e66\u914d\u7f6e",sidebar_position:8},d="\u57df\u540d\u53ca SSL \u8bc1\u4e66\u914d\u7f6e",s={unversionedId:"gettingStarted/nginxDomainConfig",id:"gettingStarted/nginxDomainConfig",title:"\u57df\u540d\u53caSSL\u8bc1\u4e66\u914d\u7f6e",description:"1. \u524d\u7f6e\u6761\u4ef6 \ud83d\udee0\ufe0f",source:"@site/docs/guides/gettingStarted/nginxDomainConfig.mdx",sourceDirName:"gettingStarted",slug:"/gettingStarted/nginxDomainConfig",permalink:"/zh-Hans/guides/gettingStarted/nginxDomainConfig",draft:!1,editUrl:"https://github.com/OpenIMSDK/docs/tree/main/docs/guides/gettingStarted/nginxDomainConfig.mdx",tags:[],version:"current",lastUpdatedAt:1746609795,formattedLastUpdatedAt:"2025\u5e745\u67087\u65e5",sidebarPosition:8,frontMatter:{title:"\u57df\u540d\u53caSSL\u8bc1\u4e66\u914d\u7f6e",sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"\u5feb\u901f\u9a8c\u8bc1",permalink:"/zh-Hans/guides/gettingStarted/quickTestServer"},next:{title:"arm\u67b6\u6784\u90e8\u7f72",permalink:"/zh-Hans/guides/gettingStarted/arm"}},l={},c=[{value:"1. \u524d\u7f6e\u6761\u4ef6 \ud83d\udee0\ufe0f",id:"1-\u524d\u7f6e\u6761\u4ef6-\ufe0f",level:2},{value:"2. \u57df\u540d\u914d\u7f6e\u6a21\u677f \ud83d\udcdd",id:"2-\u57df\u540d\u914d\u7f6e\u6a21\u677f-",level:2},{value:"3. Minio \u914d\u7f6e \ud83d\uddc4\ufe0f",id:"3-minio-\u914d\u7f6e-\ufe0f",level:2},{value:"4. \u542f\u52a8 Nginx \ud83d\ude80",id:"4-\u542f\u52a8-nginx-",level:2},{value:"5. \u767b\u5f55\u9a8c\u8bc1 \ud83d\udd0d",id:"5-\u767b\u5f55\u9a8c\u8bc1-",level:2},{value:"6. \u4fee\u6539\u5ba2\u6237\u7aef SDK \u521d\u59cb\u5316\u53c2\u6570",id:"6-\u4fee\u6539\u5ba2\u6237\u7aef-sdk-\u521d\u59cb\u5316\u53c2\u6570",level:2}],_={toc:c},m="wrapper";function u(e){var{components:n}=e,t=i(e,["components"]);return(0,r.kt)(m,o(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){a(e,n,t[n])}))}return e}({},_,t),{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u57df\u540d\u53ca-ssl-\u8bc1\u4e66\u914d\u7f6e"},"\u57df\u540d\u53ca SSL \u8bc1\u4e66\u914d\u7f6e"),(0,r.kt)("h2",{id:"1-\u524d\u7f6e\u6761\u4ef6-\ufe0f"},"1. \u524d\u7f6e\u6761\u4ef6 \ud83d\udee0\ufe0f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"open-im-server")," \u548c ",(0,r.kt)("strong",{parentName:"li"},"chat")," \u6210\u529f\u542f\u52a8\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Nginx")," \u5df2\u6210\u529f\u5b89\u88c5\uff0c\u5305\u62ec SSL \u6a21\u5757\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u6210\u529f\u7533\u8bf7\u4e24\u4e2a\u57df\u540d\u53ca\u5176 SSL \u8bc1\u4e66\uff0c\u4f8b\u5982\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"web.your_domain.com")," (\u7528\u4e8e IM \u670d\u52a1\u7aef\u53ca Web \u7aef)\uff0c ",(0,r.kt)("inlineCode",{parentName:"li"},"admin.your_domain.com"),"\uff08\u7528\u4e8e\u7ba1\u7406\u540e\u53f0\uff09\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5f00\u653e 443 \u548c 80 \u7aef\u53e3\u3002")),(0,r.kt)("h2",{id:"2-\u57df\u540d\u914d\u7f6e\u6a21\u677f-"},"2. \u57df\u540d\u914d\u7f6e\u6a21\u677f \ud83d\udcdd"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\ud83d\ude80 ",(0,r.kt)("strong",{parentName:"p"},"\u63d0\u793a"),": \u786e\u4fdd\u66ff\u6362\u6210\u60a8\u7684\u5b9e\u9645\u57df\u540d\u3001SSL \u8bc1\u4e66\u8def\u5f84\u548c SSL \u5bc6\u94a5\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-nginx"},'\n#open-im-server chat Corresponding deployment address and port\nupstream msg_gateway{\n    #IM Message server address Multiple can be specified according to the deployment\n    server 127.0.0.1:10001;\n}\nupstream im_api{\n    #IM Group user api server address Multiple can be specified according to the deployment\n    server 127.0.0.1:10002;\n}\nupstream im_chat_api{\n    #IM Business version login registration server address Multiple can be specified according to the deployment\n    server 127.0.0.1:10008;\n}\nupstream im_admin_api{\n    #IM The admin address of the commercial version can specify multiple units according to the deployment situation\n    server 127.0.0.1:10009;\n}\nupstream minio_s3_2{\n    #Minio address can be assigned to multiple modules dependingon deployment\n    server 127.0.0.1:10005;\n}\nupstream pc_web{\n    #PC web address can be validate\n    server 127.0.0.1:11001;\n}\nupstream openim_admin{\n    #Admin backend address can be used for validation\n    server 127.0.0.1:11002;\n}\n\n\n# Take the domain name "web.xx.xx" for example\nserver {\n    listen       443; #Listening on port 443\n    server_name  web.xx.xx;  #Your domain name\n    ssl on;\n    #Path of pem file for ssl certificate\n    ssl_certificate /usr/local/nginx/conf/ssh/web.your_domain.com_bundle.pem;\n    #Key file path of ssl certificate\n    ssl_certificate_key /usr/local/nginx/conf/ssh/web.your_domain.com.key;\n\n    gzip on;\n    gzip_min_length 1k;\n    gzip_buffers 4 16k;\n    gzip_comp_level 2;\n    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png application/wasm;\n    gzip_vary off;\n    gzip_disable "MSIE [1-6]\\.";\n\n    default_type application/wasm;\n\n    location / {\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://pc_web/;\n    }\n\n    location /msg_gateway{\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://msg_gateway/;\n    }\n\n    location ^~/api/{\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_set_header X-Request-Api $scheme://$host/api;\n        proxy_pass http://im_api/;\n    }\n\n    location ^~/chat/{\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://im_chat_api/;\n    }\n\n    location ^~/im-minio-api/ {\n        proxy_set_header Host $http_host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_connect_timeout 300;\n\n        proxy_http_version 1.1;\n        proxy_set_header Connection "";\n        chunked_transfer_encoding off;\n        proxy_pass http://minio_s3_2/;\n    }\n\n    location ^~/im_open_rtc/ {\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://127.0.0.1:17880;\n    }\n\n}\n\n#Take the domain name "admin.xx.xx" for example\nserver {\n    listen       443; #listening port\n    server_name  admin.your_domain.com; #Your domain server_name\n    ssl on;\n    #Path of pem file for ssl certificate\n    ssl_certificate /usr/local/nginx/conf/ssh/admin.your_domain.com_bundle.pem;\n    #Key file path of ssl certificate\n    ssl_certificate_key /usr/local/nginx/conf/ssh/admin.your_domain.com.key;\n\n\n    gzip on;\n    gzip_min_length 1k;\n    gzip_buffers 4 16k;\n    gzip_comp_level 2;\n    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png application/wasm;\n    gzip_vary off;\n    gzip_disable "MSIE [1-6]\\.";\n\n    default_type application/wasm;\n\n    location / {\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://openim_admin/;\n\n    }\n\n    location /msg_gateway{\n    proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://msg_gateway/;\n    }\n\n    location ^~/api/{\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_set_header X-Request-Api $scheme://$host/api;\n        proxy_pass http://im_api/;\n    }\n\n    location ^~/chat/{\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://im_chat_api/;\n    }\n\n    location ^~/complete_admin/{\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header X-real-ip $remote_addr;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass http://im_admin_api/;\n    }\n}\n\n#Redirection from HTTP to HTTPS redirection\nserver {\n    listen 80;\n    server_name web.your_domain.com;\n    rewrite ^(.*)$ https://$host$1 permanent;\n}\n')),(0,r.kt)("h2",{id:"3-minio-\u914d\u7f6e-\ufe0f"},"3. Minio \u914d\u7f6e \ud83d\uddc4\ufe0f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u6e90\u7801\u90e8\u7f72"),": \u4fee\u6539 ",(0,r.kt)("inlineCode",{parentName:"li"},"config/minio.yml")," \u6587\u4ef6\u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"externalAddress")," \u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},'"https://web.your_domain.com/im-minio-api"'),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Docker \u90e8\u7f72"),": \u4fee\u6539 ",(0,r.kt)("inlineCode",{parentName:"li"},".env")," \u6587\u4ef6\u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"MINIO_EXTERNAL_ADDRESS")," \u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},'"https://web.your_domain.com/im-minio-api"'),".")),(0,r.kt)("h2",{id:"4-\u542f\u52a8-nginx-"},"4. \u542f\u52a8 Nginx \ud83d\ude80"),(0,r.kt)("p",null,"\u6267\u884c\u547d\u4ee4 ",(0,r.kt)("inlineCode",{parentName:"p"},"nginx -s reload")," \u4ee5\u91cd\u8f7d Nginx \u914d\u7f6e\uff0c\u542f\u7528\u65b0\u7684\u57df\u540d\u8bbe\u7f6e\u3002"),(0,r.kt)("h2",{id:"5-\u767b\u5f55\u9a8c\u8bc1-"},"5. \u767b\u5f55\u9a8c\u8bc1 \ud83d\udd0d"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8bbf\u95ee IM web \u7aef\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"web.your_domain.com")),(0,r.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\u7ba1\u7406\u540e\u53f0\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"admin.your_domain.com"))),(0,r.kt)("h2",{id:"6-\u4fee\u6539\u5ba2\u6237\u7aef-sdk-\u521d\u59cb\u5316\u53c2\u6570"},"6. \u4fee\u6539\u5ba2\u6237\u7aef SDK \u521d\u59cb\u5316\u53c2\u6570"),(0,r.kt)("p",null,"\u5728\u5ba2\u6237\u7aef SDK \u4e2d\uff0c\u914d\u7f6e\u521d\u59cb\u5316\u53c2\u6570\u5982\u4e0b\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"apiAddr"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"https://your_domain.com/api")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"wsAddr"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"wss://your_domain.com/msg_gateway"))))}u.isMDXComponent=!0}}]);