---
title: 'dockeréƒ¨ç½²'
sidebar_position: 2
---
# ğŸ›  dockeréƒ¨ç½²

## ğŸŒŸ ç¯å¢ƒè¦æ±‚

| æ³¨æ„äº‹é¡¹ | è¯¦ç»†è¯´æ˜                                                     |
| -------- | ------------------------------------------------------------ |
| æ“ä½œç³»ç»Ÿ | linuxç³»ç»Ÿï¼ŒUbuntu 22.04æœ€ä¼˜ï¼Œrootç”¨æˆ·                        |
| ç¡¬ä»¶èµ„æº | 4Gä»¥ä¸Šå†…å­˜ï¼Œç”¨æˆ·é‡<10ä¸‡ï¼Œå•æœºéƒ¨ç½²ï¼š8C 16G 10Mb 1Tæ™®é€šç£ç›˜     |
| golang   | 1.18åŠä»¥ä¸Š                                                   |
| docker   | Docker version 24.0.5, build ced0996åŠä»¥ä¸Š                   |
| git      | 2.17.1åŠä»¥ä¸Š                                                 |

## ğŸ“¦ å­˜å‚¨ç»„ä»¶è¦æ±‚

| å­˜å‚¨ç»„ä»¶  | å»ºè®®ç‰ˆæœ¬    |
| --------- | ----------- |
| mongodb   | 6.0.2åŠä»¥ä¸Š |
| redis     | 7.0.0åŠä»¥ä¸Š |
| zookeeper | latest      |
| kafka     | latest      |
| mysql     | 5.7åŠä»¥ä¸Š   |
| minio     | latest      |

## ğŸ›  ä¸€ã€è®¾ç½®å¸¸ç”¨ç¯å¢ƒå˜é‡

> æƒ³è¦å¿«é€Ÿä½“éªŒ OpenIM APIï¼Œæ— éœ€è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä»…åœ¨å†…ç½‘ç¯å¢ƒä¸­éœ€è®¾ç½® OPENIM_APIã€‚

- **CHAT_BRANCH**
  - **æè¿°**ï¼šchatç‰ˆæœ¬
  - **é»˜è®¤å€¼**ï¼š`release-v1.4`
  - **æ³¨æ„äº‹é¡¹**ï¼šæ”¯æŒ1.3åŠä»¥ä¸Šç‰ˆæœ¬
    ```bash
    export CHAT_BRANCH="release-v1.4"
    ```

- **SERVER_BRANCH**
  - **æè¿°**ï¼šOpenIMServerç‰ˆæœ¬
  - **é»˜è®¤å€¼**ï¼š`release-v3.4`
  - **æ³¨æ„äº‹é¡¹**ï¼šæ”¯æŒ3.3åŠä»¥ä¸Šç‰ˆæœ¬
    ```bash
    export SERVER_BRANCH="release-v3.4"
    ```

- **PASSWORD**
  - **æè¿°**ï¼šç»„ä»¶å¯†ç  (mysql/mongodb/redis/minio)
  - **é»˜è®¤å€¼**ï¼š`openIM123`
  - **æ³¨æ„äº‹é¡¹**ï¼šå¯†ç â‰¥8å­—ç¬¦ï¼Œæ— ç‰¹æ®Šå­—ç¬¦
    ```bash
    export PASSWORD="openIM123"
    ```

- **USER**
  - **æè¿°**ï¼šç»„ä»¶ç”¨æˆ·å (mysql/mongodb/redis/minio)
  - **é»˜è®¤å€¼**ï¼š`root`
  - **æ³¨æ„äº‹é¡¹**ï¼šå»ºè®®ä¿æŒrootï¼Œå…¶ä»–è´¦å·æœªæµ‹è¯•
    ```bash
    export USER="root"
    ```

- **OPENIM_IP**
  - **æè¿°**ï¼šAPIåœ°å€
  - **é»˜è®¤å€¼**ï¼šæœ‰å¤–ç½‘IPæ—¶ä¼šè‡ªåŠ¨è®¾ç½®ã€‚
  - **æ³¨æ„äº‹é¡¹**ï¼šå®¢æˆ·ç«¯ä½¿ç”¨æ­¤åœ°å€è®¿é—®ï¼Œæœ‰å¤–ç½‘IPæ—¶ä¼šè‡ªåŠ¨è®¾ç½®ï¼Œå†…ç½‘ç¯å¢ƒä¸‹éœ€æ‰‹åŠ¨è®¾ç½®ï¼Œæ›¿æ¢ ip ä¸ºå¤–ç½‘çš„ IPã€‚
    ```bash
    export OPENIM_IP="http://ip:10002"
    ```

- **DATA_DIR**
  - **æè¿°**ï¼šæ•°æ®å·ç›®å½•
  - **é»˜è®¤å€¼**ï¼š`./`
  - **æ³¨æ„äº‹é¡¹**ï¼šæ‰€æœ‰æ•°æ®éƒ½ä¼šå­˜å‚¨åœ¨æ­¤ç›®å½•ä¸‹ï¼Œå»ºè®®è®¾ç½®å¤§ç£ç›˜ä¸‹çš„ç›®å½•ã€‚
    ```bash
    export DATA_DIR="./"
    ```

+ **PROMETHEUS_ENABLE**

  + **æè¿°**: å¯ç”¨ Prometheus çš„æ ‡å¿—
  + **é»˜è®¤å€¼**: `false`

  ```bash
  export PROMETHEUS_ENABLE=true
  ```

> + + **æè¿°**: æœ‰å…³éƒ¨ç½²å’Œé…ç½® Prometheus ä»¥åŠç›‘æ§çš„è¯¦ç»†æ–‡æ¡£å’Œå‚è€ƒèµ„æ–™
> + + **é“¾æ¥**: [Prometheus å’Œç›‘æ§éƒ¨ç½²æŒ‡å—](https://github.com/openimsdk/open-im-server/blob/main/docs/contrib/prometheus-grafana.md)

---

---

### ğŸ›  æ›´å¤šç¯å¢ƒå˜é‡

ğŸŸ¢ è¯¦ç»†äº†è§£å„ç§ç¯å¢ƒå˜é‡ï¼Œè¯·å‚è€ƒ [æ­¤æ–‡æ¡£](https://github.com/openimsdk/open-im-server/blob/main/docs/contrib/environment.md).

> âš ï¸ **æ³¨æ„**ï¼šä½¿ç”¨ `export` è®¾ç½®çš„ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§é«˜äºè„šæœ¬ä¸­çš„å˜é‡ã€‚

---


## ğŸš€ äºŒã€æ‹‰å–é•œåƒå¹¶å¯åŠ¨


```bash
git clone https://github.com/openim-sigs/openim-docker openim/openim-docker && export openim=$(pwd)/openim && cd $openim/openim-docker && make init && docker compose up -d
```

ğŸŸ¢ å¦‚æœæ‚¨çš„dockerä¸æ”¯æŒcomposeï¼Œå»ºè®®æŒ‰ç…§ [è¿™ä¸ª](https://docs.docker.com/compose/install/linux/)å‡çº§.



### ğŸ“œ æŸ¥çœ‹æ—¥å¿—

```bash
docker compose logs openim-server
docker compose logs openim-chat
```

ğŸŸ¢ æ›´å¤šæ—¥å¿—ä½äºï¼š`openim-server/branch/logs/` å’Œ `openim-chat/branch/logs`

### ğŸ©º æŸ¥çœ‹å¥åº·çŠ¶æ€

```bash
docker ps
```
![docker-ps](./assets/docker-ps.png)

## ä¸‰ã€å¿«é€ŸéªŒè¯

è¯·å‚è€ƒ[å¿«é€ŸéªŒè¯](./quickTestServer)æ–‡æ¡£


## å››ã€ç®¡ç†åå°å’Œç›‘æ§ç³»ç»Ÿ

è¯·å‚è€ƒ [ç®¡ç†åå°å’Œç›‘æ§ç³»ç»Ÿ](./admin) æ–‡æ¡£ã€‚





## â“ **å¸¸è§é—®é¢˜** ğŸ§

---

### 1. ä½¿ç”¨å¤–éƒ¨ç»„ä»¶å¦‚ä½•ä¿®æ”¹? ğŸ› ï¸

**ä¾‹ï¼šä½¿ç”¨å¤–éƒ¨mysqlğŸ”—ï¼š**

- ğŸ“ ç¼–è¾‘ `docker-compose.yaml` å¹¶æ³¨é‡Šæ‰ mysql é…ç½® åŠ å¯¹åº”çš„depends_on ã€‚
- ğŸ“ ç¼–è¾‘ `scripts/install/environment.sh` å¹¶ä¿®æ”¹ mysql é…ç½®ã€‚
- ğŸ’» æ‰§è¡Œå‘½ä»¤: `make init`
- ğŸš€ æ‰§è¡Œå‘½ä»¤: `docker compose up -d`

---

### 2. å¥åº·çŠ¶æ€ä¸º `starting`? ğŸŸ 

é¦–æ¬¡å¥åº·æ£€æŸ¥å‰ï¼ŒDocker é»˜è®¤çŠ¶æ€ä¸º `starting`â³ã€‚çº¦ 1 åˆ†é’Ÿåï¼ŒçŠ¶æ€å˜æ›´ä¸º `healthy`âœ…ã€‚

---

### 3. ç«¯å£æ˜ å°„ ğŸŒ

Docker networks å…è®¸ç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®ğŸ”§ï¼Œæ‚¨å¯ä»¥æ­£å¸¸åœ°æ˜ å°„ç«¯å£ğŸ”€ã€‚

---

### 4. å…³äº Docker ç‰ˆæœ¬ ğŸ‹

æ–°ç‰ˆ Docker å·²ç»æ•´åˆäº† docker-compose. è€ç‰ˆæœ¬çš„ Docker å¯èƒ½ä¸æ”¯æŒ gateway åŠŸèƒ½âŒã€‚æˆ‘ä»¬å»ºè®®æ‚¨å‡çº§åˆ°è¾ƒæ–°çš„ç‰ˆæœ¬ï¼Œä¾‹å¦‚ `23.0.1`ğŸ”

---
