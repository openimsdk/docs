---
title: 'Docker Deployment'
sidebar_position: 2
---
# ğŸ›  Docker Deployment

## ğŸŒŸ Environment Requirements

| Considerations | Details                                                               |
| -------------- | ---------------------------------------------------------------------- |
| Operating System | Linux, ideally Ubuntu 22.04, root user                              |
| Hardware Resources | At least 4GB RAM, for user volume <100,000, single machine deployment: 8C 16G 10Mb 1T regular disk |
| golang          | 1.18 and above                                                        |
| docker          | Docker version 24.0.5, build ced0996 or newer                        |
| git             | 2.17.1 and above                                                      |

## ğŸ“¦ Storage Component Requirements

| Storage Component | Recommended Version |
| ----------------- | ------------------- |
| mongodb           | 6.0.2 and above     |
| redis             | 7.0.0 and above     |
| zookeeper         | latest              |
| kafka             | latest              |
| mysql             | 5.7 and above       |
| minio             | latest              |

## ğŸ›  1. Set Common Environment Variables

- **CHAT_BRANCH**
  - **Description**: chat version
  - **Default**: `release-v1.3`
  - **Consideration**: Supports version 1.3 and above
    ```bash
    export CHAT_BRANCH="release-v1.3"
    ```

- **SERVER_BRANCH**
  - **Description**: OpenIMServer version
  - **Default**: `release-v3.3`
  - **Consideration**: Supports version 3.3 and above
    ```bash
    export SERVER_BRANCH="release-v3.3"
    ```

- **PASSWORD**
  - **Description**: Component password (mysql/mongodb/redis/minio)
  - **Default**: `openIM123`
  - **Consideration**: Password should be â‰¥8 characters and without special characters
    ```bash
    export PASSWORD="openIM123"
    ```

- **USER**
  - **Description**: Component username (mysql/mongodb/redis/minio)
  - **Default**: `root`
    ```bash
    export USER="root"
    ```

- **OPENIM_IP**
  - **Description**: API address
  - **Note**: Automatically fetched if there's an external IP; for internal network, set it to the server IP
    ```bash
    export OPENIM_IP="http://ip:10002"
    ```

- **DATA_DIR**
  - **Description**: Data volume directory
  - **Default**: `./`
    ```bash
    export DATA_DIR="./"
    ```

---

---

### ğŸ›  More Environment Variables

ğŸŸ¢ For a detailed understanding of various environment variables, please refer to [this document](https://github.com/openimsdk/open-im-server/blob/main/docs/contrib/environment.md).

> âš ï¸ **Note**: Variables set using `export` have higher priority than the ones in the script.

---


## ğŸš€ 2. Pull and Launch Image

```bash
git clone https://github.com/openim-sigs/openim-docker openim/openim-docker && export openim=$(pwd)/openim && cd $openim/openim-docker && make init && docker compose up -d
```

ğŸŸ¢ If your docker doesn't support compose, it's recommended to upgrade following [this guide](https://docs.docker.com/compose/install/linux/).

### ğŸ“œ View Logs

```bash
docker compose logs openim-server
docker compose logs openim-chat
```

ğŸŸ¢ More logs can be found at: `openim-server/branch/logs/` and `openim-chat/branch/logs`

### ğŸ©º Check Health Status

```bash
docker ps
```
![docker-ps](./assets/docker-ps.png)

## 3. Quick Verification

Please refer to the [Quick Verification](./quickTestServer) document.

## â“ **Frequently Asked Questions** ğŸ§

---

### 1. How to modify using external components? ğŸ› ï¸

**Example: Using external mysqlğŸ”—:**

- ğŸ“ Edit `docker-compose.yaml` and comment out mysql configuration and its corresponding depends_on.
- ğŸ“ Edit `scripts/install/environment.sh` and change the mysql configuration.
- ğŸ’» Run the command: `make init`
- ğŸš€ Run the command: `docker compose up -d`

---

### 2. Health status is `starting`? ğŸŸ 

Initially, before the health check, Docker's default status is `starting`â³. Approximately after 1 minute, the status changes to `healthy`âœ….

---

### 3. Port Mapping ğŸŒ

Docker networks allow for user-defined settingsğŸ”§. You can map ports as usualğŸ”€.

---

### 4. About Docker Version ğŸ‹

The new version of Docker has integrated docker-compose. Older versions of Docker might not support the gateway featureâŒ. It's recommended to upgrade to a newer version, such as `23.0.1`ğŸ”.

---
