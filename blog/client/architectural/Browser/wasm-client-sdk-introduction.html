<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-blog docs-doc-id-client/architectural/Browser/wasm-client-sdk-introduction">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Wasm Client SDK架构介绍 | OpenIM Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.rentsoft.cn/blog/client/architectural/Browser/wasm-client-sdk-introduction"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-blog-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-blog-current"><meta data-rh="true" property="og:title" content="Wasm Client SDK架构介绍 | OpenIM Docs"><meta data-rh="true" name="description" content="前言"><meta data-rh="true" property="og:description" content="前言"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.rentsoft.cn/blog/client/architectural/Browser/wasm-client-sdk-introduction"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/zh-Hans/blog/client/architectural/Browser/wasm-client-sdk-introduction" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/blog/client/architectural/Browser/wasm-client-sdk-introduction" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/blog/client/architectural/Browser/wasm-client-sdk-introduction" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NRY7H605ZD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="OpenIM Docs" href="/opensearch.xml">





<script src="/embed.js"></script><link rel="stylesheet" href="/assets/css/styles.c2eae4fa.css">
<link rel="preload" href="/assets/js/runtime~main.71681e47.js" as="script">
<link rel="preload" href="/assets/js/main.1efffa4f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo/light.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--light_HNdA logo-icon" width="107.5px"><img src="/logo/dark.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--dark_i4oU logo-icon" width="107.5px"></div></a><a class="navbar__item navbar__link" href="/guides/introduction">Guides</a><a class="navbar__item navbar__link" href="/sdks/introduction">Client SDKs</a><a class="navbar__item navbar__link" href="/restapi/apis/introduction">Server APIs</a><a class="navbar__item navbar__link" href="/blog/introduction">Blog</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="relative flex items-center gap-2"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search" id="search-bar"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><a href="https://github.com/OpenIMSDK" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link dev-portal-signup dev-portal-link header-github-link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/zh-Hans/blog/client/architectural/Browser/wasm-client-sdk-introduction" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li><li><a href="/blog/client/architectural/Browser/wasm-client-sdk-introduction" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog/introduction">introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/golang/architectural/example">IMSDK/Server</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/client/build/Electron/electron-demo-build">Client</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/blog/client/build/Electron/electron-demo-build">编译部署</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/blog/client/architectural/Browser/wasm-client-sdk-introduction">SDK架构设计</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/blog/client/architectural/Browser/wasm-client-sdk-introduction">Browser</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/client/architectural/Browser/wasm-client-sdk-introduction">Wasm Client SDK架构介绍</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/blog/client/optimization/Browser/wasm-client-sdk-optimization">性能与优化</a></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Wasm Client SDK 架构介绍</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="#前言" class="hash-link" aria-label="Direct link to 前言" title="Direct link to 前言">​</a></h2><p>在现代 Web 开发中，许多场景都需要即时通讯功能，例如聊天、推送、协作等。然而，传统的前端方案往往依赖第三方云服务，带来高额成本和数据安全隐患。现在，借助 OpenIMSDK 这一开源项目，我们可以轻松构建自托管的即时通讯服务，并在客户端使用 WebAssembly (WASM) 进行高效的跨平台支持。本篇文章将介绍我们是如何基于 Go + WebAssembly + SQLite 虚拟化技术打造一套轻量且强大的 Web SDK 的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-架构概述">1. 架构概述<a href="#1-架构概述" class="hash-link" aria-label="Direct link to 1. 架构概述" title="Direct link to 1. 架构概述">​</a></h2><p>本 SDK 的目标是让开发者能在浏览器环境下直接集成 OpenIMSDK 的即时通讯能力，同时尽可能复用原生（Go）版本的 OpenIMSDK Core，做到<strong>“一套核心、多端复用”</strong>。为此，我们选择了以下技术栈：</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-go--webassembly">1.1 Go + WebAssembly<a href="#11-go--webassembly" class="hash-link" aria-label="Direct link to 1.1 Go + WebAssembly" title="Direct link to 1.1 Go + WebAssembly">​</a></h3><p>• 使用 Go 语言编写的核心逻辑，包括通信协议解析、消息拉取、消息同步等。<br>
<!-- -->•	借助 WASM 将核心模块打包成可在浏览器执行的二进制。可在前端直接使用，无需重新实现大量逻辑。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-webassembly-wasm">1.2 WebAssembly (WASM)<a href="#12-webassembly-wasm" class="hash-link" aria-label="Direct link to 1.2 WebAssembly (WASM)" title="Direct link to 1.2 WebAssembly (WASM)">​</a></h3><p>• 能将 Go 代码编译为可在浏览器运行的二进制，同时具备接近原生的性能表现。<br>
<!-- -->• 提供必要的 JS 接口 (host functions)，支持 SDK 与前端进行双向通信。 </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-数据存储sqlite--sqljs--indexeddb">1.3 数据存储：SQLite + sql.js + IndexedDB<a href="#13-数据存储sqlite--sqljs--indexeddb" class="hash-link" aria-label="Direct link to 1.3 数据存储：SQLite + sql.js + IndexedDB" title="Direct link to 1.3 数据存储：SQLite + sql.js + IndexedDB">​</a></h3><p>• 使用 sql.js（JavaScript 版 SQLite）在浏览器中模拟本地数据库。<br>
<!-- -->• 底层将数据存储在浏览器的 IndexedDB 中，但对开发者而言完全透明，仍然以原生 SQL 形式进行读写。<br>
<!-- -->•	这种“虚拟化”处理方式能统一前端与原生端的数据库使用模式，减少多端差异带来的维护成本。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-api-封装json-通信">1.4 API 封装：JSON 通信<a href="#14-api-封装json-通信" class="hash-link" aria-label="Direct link to 1.4 API 封装：JSON 通信" title="Direct link to 1.4 API 封装：JSON 通信">​</a></h3><p>• 通过 JSON 数据格式在 JS 与 WASM 之间进行消息传递，降低语言间调用的复杂度。<br>
<!-- -->• 封装一层更贴近 JavaScript 开发者习惯的接口，便于快速上手。  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2主要技术原理">2、主要技术原理<a href="#2主要技术原理" class="hash-link" aria-label="Direct link to 2、主要技术原理" title="Direct link to 2、主要技术原理">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-go--webassembly">2.1 Go + WebAssembly<a href="#21-go--webassembly" class="hash-link" aria-label="Direct link to 2.1 Go + WebAssembly" title="Direct link to 2.1 Go + WebAssembly">​</a></h3><blockquote><p>背景：<br>
<!-- -->Go 语言在高并发和网络编程上具有天然的优势，同时能够方便地将逻辑抽象、封装成一个单独的核心模块。自 Go 1.11 开始，官方就支持将 Go 代码编译为 WebAssembly 文件，这为我们在 Web 端直接运行原生逻辑提供了可能。</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="编译过程">编译过程<a href="#编译过程" class="hash-link" aria-label="Direct link to 编译过程" title="Direct link to 编译过程">​</a></h4><p>  •	环境变量：在终端设置 GOOS=js GOARCH=wasm，将目标平台指定为 js/wasm。<br>
<!-- -->•	生成 .wasm 文件：编译后会得到一个 .wasm 文件和一个配套的 wasm_exec.js，后者是 Go 官方提供的运行时，用来启动并管理 WASM 侧的 Go 代码。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="交互方式">交互方式<a href="#交互方式" class="hash-link" aria-label="Direct link to 交互方式" title="Direct link to 交互方式">​</a></h4><p>  •	JSON 消息传递：由于 Go 与 JS 分处不同的运行环境，直接传递复杂数据结构较为困难。因此在 Go 侧，我们定义了一组统一的 JSON 接口用于接收/返回数据；在 JS 侧，通过序列化/反序列化实现两边通信，这样即便语言不同，也能无缝对接。<br>
<!-- -->•	并发与网络：Go 依旧可以使用 Goroutine 等特性处理网络 I/O，浏览器端通过 WebSocket 或其他方式连接到自托管的 OpenIM 服务器，保持消息同步。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-sqlite-虚拟化">2.2 SQLite 虚拟化<a href="#22-sqlite-虚拟化" class="hash-link" aria-label="Direct link to 2.2 SQLite 虚拟化" title="Direct link to 2.2 SQLite 虚拟化">​</a></h3><blockquote><p>为什么需要本地存储？<br>
<!-- -->即时通讯场景中，客户端往往需要将聊天记录、用户信息、会话列表等存储在本地，以便在断网或刷新后能快速恢复、离线查看。在桌面或移动端，SQLite 常被用作本地数据库；在浏览器环境，我们借助 sql.js 来模拟这一行为。</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sqljs-的工作原理">sql.js 的工作原理<a href="#sqljs-的工作原理" class="hash-link" aria-label="Direct link to sql.js 的工作原理" title="Direct link to sql.js 的工作原理">​</a></h4><p>  • sql.js: 这是一个将 SQLite 以 Emscripten 编译成 JavaScript 的项目，可在浏览器中直接执行原生的 SQL 语句。<br>
<!-- -->• IndexedDB: 由于浏览器环境无法直接访问本地文件系统，sql.js 会将所有数据储存在内存或浏览器原生数据库 IndexedDB 中，并持久化。<br>
<!-- -->• 统一数据库访问: 从业务层面看，所有客户端SDK都在使用“一套 SQL”读写，无需刻意区分。对于开发者来说，迁移或共享部分逻辑时非常简便。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-前端-api-设计">2.3 前端 API 设计<a href="#23-前端-api-设计" class="hash-link" aria-label="Direct link to 2.3 前端 API 设计" title="Direct link to 2.3 前端 API 设计">​</a></h3><p>   • SDK 对外暴露的方法: 例如 login(), sendMessage(), getConversationListSplit() 等等；这些接口在内部会通过 JSON 字符串包装后调用 WASM 内部的对应函数。<br>
<!-- -->• 事件/回调处理: 例如新消息通知、连接状态变更等事件，采用在 JavaScript 中设置事件监听的方式实现。一旦有消息从 WASM 返回，则通过相应事件进行通知。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-核心流程">3. 核心流程<a href="#3-核心流程" class="hash-link" aria-label="Direct link to 3. 核心流程" title="Direct link to 3. 核心流程">​</a></h2><p align="center"><img loading="lazy" src="/assets/images/wasm_call_map-e7e69dc8ab3efdafd158050a67b3de4c.png" alt="预览图" width="80%" class="img_ev3q"></p><p>如上图所示，WASM SDK 的核心调用流程为：</p><ol><li>用户发起对 SDK API 的调用（由 JS 层对外暴露）。</li><li>JS SDK 层将调用请求传递给 WASM 实现的 OpenIMSDK Core。</li><li>WASM Core 反向调用 JS 层，执行实际的 SQLite 读写逻辑（由 sql.js 实现）。</li><li>JS 数据库访问逻辑 完成 SQLite 操作，并将结果返回给 WASM Core。</li><li>WASM Core 对结果进行封装处理后，返回给 JS SDK 层。</li><li>最终，JS 层 将处理结果返回给调用的用户。</li></ol><blockquote><p><strong>性能优化</strong>：JS 层执行的 SQLite 操作都被放到了 Web Worker 中，避免了 UI 线程的阻塞。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-优点与局限性">4. 优点与局限性<a href="#4-优点与局限性" class="hash-link" aria-label="Direct link to 4. 优点与局限性" title="Direct link to 4. 优点与局限性">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="优点">优点<a href="#优点" class="hash-link" aria-label="Direct link to 优点" title="Direct link to 优点">​</a></h3><ol><li>高效复用，降低维护成本<br>•	由于各端（Web、桌面、移动）可以共用同一个 OpenIMSDK Core（Go 语言编写），只需编译到对应平台即可，大幅降低多人多端项目的开发与维护难度。</li><li>接近原生性能<br>•	WASM 代码运行效率高，对加解密、序列化、消息同步等较重负载处理更友好，让大型或复杂的即时通讯应用在浏览器环境下依然表现顺畅。</li><li>稳定的本地缓存<br>•	通过 sql.js + IndexedDB 的本地缓存，用户可以在刷新、断网后仍能访问聊天记录和会话列表，提高了可用性与用户体验。</li><li>安全性<br>•	WebAssembly 运行在沙箱环境中，JS 与 WASM 间的通信边界清晰，可有效降低非预期的内存访问风险。</li><li>快速迭代<br>•	当需要更新核心逻辑时，只要重新编译 .wasm 文件并替换部署即可；前端保持基本接口不变，升级成本较低。</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="局限性">局限性<a href="#局限性" class="hash-link" aria-label="Direct link to 局限性" title="Direct link to 局限性">​</a></h3><ol><li>浏览器兼容性<br>•	现代浏览器（Chrome、Firefox、Safari、Edge 等）对 WebAssembly 的支持已经相对完善，但在老旧浏览器上可能会出现兼容性问题。<br>•	IndexedDB 在某些特定环境下也存在奇怪的兼容性或容量限制，需要提前规划。</li><li>学习与调试难度<br>•	虽然接入 SDK 时只要调用 JS 层封装的接口即可，但如果出现底层问题，排查 Go WASM 与 sql.js 交互会比单纯的 JS 调试更复杂。</li><li>初次加载文件体积<br>•	.wasm 文件可能相对较大，在网络环境较差时会有额外的加载时间。可配合 CDN、懒加载等策略进行优化。</li><li>Web Worker 通信开销<br>•	虽然将 SQLite 操作放到 Web Worker 能避免阻塞 UI，但也会带来一定的跨线程通信开销，需要在业务设计中平衡。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-总结">5. 总结<a href="#5-总结" class="hash-link" aria-label="Direct link to 5. 总结" title="Direct link to 5. 总结">​</a></h2><p>这套基于 WebAssembly 和虚拟化 SQLite 的 OpenIM Web SDK，在最大程度继承了 Go 端的网络与业务逻辑的同时，也充分利用了浏览器自带的 IndexedDB 进行本地持久化存储。对开发者而言，无需重写一套复杂的前端业务逻辑，即可获得接近原生性能的即时通讯能力。<br>
<!-- -->•	共享核心：与其他平台（移动、桌面）的 SDK 共用同一份核心逻辑，减少重复开发。<br>
<!-- -->•	本地缓存：用户可在浏览器端流畅查看消息历史，即便网络不佳也能完成大部分操作。<br>
<!-- -->•	自托管：开发者对后端服务有完全掌控力，降低外部依赖所带来的数据安全与成本压力。</p><p>如果你正在寻找一款可在 Web 端灵活部署的开源即时通讯方案，或者想要掌控数据与服务端架构的自托管模式，欢迎尝试这款 SDK。它不仅能带来较高性能和安全性，也能简化你的前后端协作流程，实现快速交付。</p><p>更多资源<br>
<!-- -->• <a href="https://www.openim.io" target="_blank" rel="noopener noreferrer">OpenIMSDK 官网</a><br>
<!-- -->• <a href="https://docs.openim.io" target="_blank" rel="noopener noreferrer">OpenIMSDK 官方文档</a><br>
<!-- -->• <a href="https://github.com/openimsdk" target="_blank" rel="noopener noreferrer">GitHub 仓库</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/OpenIMSDK/docs/tree/main/docs/blog/client/architectural/Browser/wasm-client-sdk-introduction.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-05-14T08:27:43.000Z">May 14, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/client/build/Flutter/flutter-demo-build"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Flutter Demo 的快速编译与运行</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/client/optimization/Browser/wasm-client-sdk-optimization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Wasm Client SDK线上优化</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link toc-highlight">前言</a></li><li><a href="#1-架构概述" class="table-of-contents__link toc-highlight">1. 架构概述</a><ul><li><a href="#11-go--webassembly" class="table-of-contents__link toc-highlight">1.1 Go + WebAssembly</a></li><li><a href="#12-webassembly-wasm" class="table-of-contents__link toc-highlight">1.2 WebAssembly (WASM)</a></li><li><a href="#13-数据存储sqlite--sqljs--indexeddb" class="table-of-contents__link toc-highlight">1.3 数据存储：SQLite + sql.js + IndexedDB</a></li><li><a href="#14-api-封装json-通信" class="table-of-contents__link toc-highlight">1.4 API 封装：JSON 通信</a></li></ul></li><li><a href="#2主要技术原理" class="table-of-contents__link toc-highlight">2、主要技术原理</a><ul><li><a href="#21-go--webassembly" class="table-of-contents__link toc-highlight">2.1 Go + WebAssembly</a></li><li><a href="#22-sqlite-虚拟化" class="table-of-contents__link toc-highlight">2.2 SQLite 虚拟化</a></li><li><a href="#23-前端-api-设计" class="table-of-contents__link toc-highlight">2.3 前端 API 设计</a></li></ul></li><li><a href="#3-核心流程" class="table-of-contents__link toc-highlight">3. 核心流程</a></li><li><a href="#4-优点与局限性" class="table-of-contents__link toc-highlight">4. 优点与局限性</a><ul><li><a href="#优点" class="table-of-contents__link toc-highlight">优点</a></li><li><a href="#局限性" class="table-of-contents__link toc-highlight">局限性</a></li></ul></li><li><a href="#5-总结" class="table-of-contents__link toc-highlight">5. 总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container-fluid container"><div class="margin-bottom--sm"><a class="footerLogoLink_DDai" href="/"><img src="/logo/light.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--light_HNdA footer__logo" height="38px"><img src="/logo/dark.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" height="38px"></a></div><p class="footer__description">OpenIM is an open source instant messaging component built by IM technical experts. OpenIM includes IM server and client SDK, which realizes important features such as high performance, light weight, and easy expansion. By integrating OpenIM components and privatizing the deployment of the server, developers can quickly integrate instant messaging and real-time network capabilities into their own applications, and ensure the security and privacy of business data.</p><div class="footer__row"><div class="footer__data"><div class="footer__cta"><p>Join the Slack channel to communicate and discuss with everyone!</p><a href="https://join.slack.com/t/openimsdk/shared_invite/zt-2hljfom5u-9ZuzP3NfEKW~BJKbpLm0Hw" target="_blank" rel="noopener noreferrer">Join</a></div></div><div class="links"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openim.io/commercial" target="_blank" rel="noopener noreferrer" class="footer__link-item">Business</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openim.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Us</a></li><li class="footer__item"><a href="mailto:contact@openim.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/guides/introduction">Documentation</a></li><li class="footer__item"><a href="https://join.slack.com/t/openimsdk/shared_invite/zt-2hljfom5u-9ZuzP3NfEKW~BJKbpLm0Hw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community</a></li></ul></div></div></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © OpenIM since 2023. All rights reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.71681e47.js"></script>
<script src="/assets/js/main.1efffa4f.js"></script>
</body>
</html>