<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-guides docs-doc-id-benchmark_test">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Stress and Reliability Test Report | OpenIM Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.rentsoft.cn/guides/benchmark_test"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-guides-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-guides-current"><meta data-rh="true" property="og:title" content="Stress and Reliability Test Report | OpenIM Docs"><meta data-rh="true" name="description" content="Background"><meta data-rh="true" property="og:description" content="Background"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.rentsoft.cn/guides/benchmark_test"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/zh-Hans/guides/benchmark_test" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/guides/benchmark_test" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/guides/benchmark_test" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NRY7H605ZD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="OpenIM Docs" href="/opensearch.xml">





<script src="/embed.js"></script><link rel="stylesheet" href="/assets/css/styles.c2eae4fa.css">
<link rel="preload" href="/assets/js/runtime~main.fdeac86e.js" as="script">
<link rel="preload" href="/assets/js/main.081581e0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo/light.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--light_HNdA logo-icon" width="107.5px"><img src="/logo/dark.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--dark_i4oU logo-icon" width="107.5px"></div></a><a class="navbar__item navbar__link" href="/guides/introduction">Guides</a><a class="navbar__item navbar__link" href="/sdks/introduction">Client SDKs</a><a class="navbar__item navbar__link" href="/restapi/apis/introduction">Server APIs</a><a class="navbar__item navbar__link" href="/blog/introduction">Blog</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="relative flex items-center gap-2"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search" id="search-bar"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><a href="https://github.com/OpenIMSDK" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link dev-portal-signup dev-portal-link header-github-link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/zh-Hans/guides/benchmark_test" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li><li><a href="/guides/benchmark_test" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/guides/introduction">OpenIM</a><button aria-label="Toggle the collapsible sidebar category &#x27;OpenIM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/guides/gettingStarted/imSourceCodeDeployment">快速部署</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/guides/pressure_test">Stress Test Report</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/guides/solution/offlinePush">解决方案</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/guides/benchmark_test">Stress and Reliability Test Report</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>OpenIM Stress and Reliability Testing</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a href="#background" class="hash-link" aria-label="Direct link to Background" title="Direct link to Background">​</a></h2><p>To comprehensively test OpenIM, it is first necessary to clarify its core functions and architecture. OpenIM is not a standalone chat application like WeChat or Slack; instead, it is an open-source instant messaging solution that includes IMSDK (for client integration) and IMServer (for private deployment). This allows developers to easily integrate instant messaging features into their own applications, providing an alternative to cloud-based instant messaging services like Twilio or Sendbird. Since IMSDK is built on the openim-sdk-core written in Go, simulating large-scale user scenarios on mobile devices presents certain challenges. In reality, testing with thousands of mobile phones is impractical. Therefore, we have designed two sets of testing programs:</p><ol><li><p><strong>Test Program A - Reliability</strong>:</p><ul><li>This program loads and runs openim-sdk-core on a server to simulate IMSDK instances. Each instance uses SQLite for message storage. This approach can comprehensively simulate client behavior, including sending, receiving, storing messages, and callbacks, effectively verifying the reliability and latency of message transmission. However, running too many SDK instances on a single server may degrade IMSDK performance.</li></ul></li><li><p><strong>Test Program B - Stress</strong>:</p><ul><li>This program streamlines IMSDK functionality, retaining only login and message sending/receiving features. It aims to simulate high-concurrency scenarios by launching a large number of instances to evaluate server performance and stability under heavy load. Although this method cannot fully verify all client SDK processes, it is crucial for assessing the server&#x27;s capacity and resource management strategies. Its downside is that it cannot fully simulate IMSDK functionality, thus unable to verify the reliability of message transmission.</li></ul></li></ol><p>By combining these two testing programs, Program B is primarily used to simulate a large number of users online simultaneously and engaging in message interactions to increase server load; Program A is used to load IMSDK and assess message reliability and latency through sampling statistics. The combined use of both programs better simulates real user scenarios and provides an objective test report for IMSDK. This dual testing strategy ensures a comprehensive evaluation and verification of the system from different perspectives.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reliability-and-latency">Reliability and Latency<a href="#reliability-and-latency" class="hash-link" aria-label="Direct link to Reliability and Latency" title="Direct link to Reliability and Latency">​</a></h2><p>Message reliability typically refers to the reliability of message delivery, known as &quot;message guaranteed delivery.&quot; This means that once a message is sent, it must be successfully received by the recipient. Considering the complexity of network environments and the uncertainty of user online statuses, message reliability undoubtedly becomes a core performance metric of an IM system and a significant implementation challenge. When we talk about the &quot;reliability&quot; of an IM system, it mainly refers to the reliability of chat message delivery. It should be noted that &quot;messages&quot; here are broad, including various invisible commands and notifications to users, such as group join/leave notifications, friend addition notifications, etc.</p><p>Message latency refers to the time elapsed from when client A creates and sends a message to when client B successfully receives and stores it in the database. Some IM systems only count the time from when the message is sent from the client to when the server receives it, which is not comprehensive. The correct approach should include the overall time from client A sending to client B receiving.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-resources"><strong>Testing Resources</strong><a href="#testing-resources" class="hash-link" aria-label="Direct link to testing-resources" title="Direct link to testing-resources">​</a></h3><ul><li><p><strong>Server 1</strong>: Ubuntu 22.04.2, 16 Core, 64GB RAM, 150GB HDD: Deploys components and IMServer; concurrently deploys Test Program B, and possibly Test Program A on shared memory <code>/dev/shm</code>.</p></li><li><p><strong>Server 2</strong>: Ubuntu 18.04.5, 4 Core, 8GB RAM, 40GB HDD: Deploys Test Program A on shared memory <code>/dev/shm</code>.</p></li></ul><p>In the server&#x27;s <code>start-config.yml</code>, adjust the service instances to <code>openim-push: 8</code>, <code>openim-msgtransfer: 8</code>, and keep other instances at 1.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-scenarios-and-results"><strong>Test Scenarios and Results</strong><a href="#test-scenarios-and-results" class="hash-link" aria-label="Direct link to test-scenarios-and-results" title="Direct link to test-scenarios-and-results">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="test-1-200-users">Test 1: 200 Users<a href="#test-1-200-users" class="hash-link" aria-label="Direct link to Test 1: 200 Users" title="Direct link to Test 1: 200 Users">​</a></h4><ul><li><p><strong>Test Program A</strong> simulates 200 users, with 100 logging in immediately and sending messages to small groups and friends.</p></li><li><p><strong>Test Program A</strong> collects message integrity and latency statistics using:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -lgr </span><span class="token number" style="color:rgb(181, 206, 168)">0.5</span><span class="token plain"> -imf -crg -ckgn -ckcon -sem -ckmsn -u </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token plain"> -su </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> -lg </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> -cg </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> -cgm </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> -sm </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> -gm </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> -reg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>At this time, Test Program A is deployed on Server 1&#x27;s shared memory <code>/dev/shm</code>.</p></li></ul><table><thead><tr><th>Parameter/Result</th><th>Description</th></tr></thead><tbody><tr><td><strong>Test Purpose</strong></td><td>Test message reliability and latency with a small number of users</td></tr><tr><td><strong>Number of Users</strong></td><td>200 users, with 100 logging in immediately and 100 logging in with delay</td></tr><tr><td><strong>Number and Size of Groups</strong></td><td>Each user joins 0-10 regular groups, each group has 5 members</td></tr><tr><td><strong>Message Sending Frequency</strong></td><td>Peak of 150 messages/s</td></tr><tr><td><strong>Total Number of Messages</strong></td><td>112,350</td></tr><tr><td><strong>Message Integrity</strong></td><td>100% (All messages accurately delivered)</td></tr><tr><td><strong>Average Message Latency</strong></td><td>0.231 seconds</td></tr><tr><td><strong>Maximum Message Latency</strong></td><td>1.703 seconds</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="test-2-50000-online-users--small-groups">Test 2: 50,000 Online Users + Small Groups<a href="#test-2-50000-online-users--small-groups" class="hash-link" aria-label="Direct link to Test 2: 50,000 Online Users + Small Groups" title="Direct link to Test 2: 50,000 Online Users + Small Groups">​</a></h4><ul><li><p><strong>Test Program B</strong>: Simulates 50,000 online users, randomly sending messages.</p></li><li><p><strong>Test Program A</strong>: Simulates 100 users, with 80 logging in immediately and sending messages to small groups and friends.</p></li><li><p><strong>Test Program A</strong> registers 100,000 users:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -reg -u </span><span class="token number" style="color:rgb(181, 206, 168)">100000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Test Program B</strong> starts 50,000 online users:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -s </span><span class="token number" style="color:rgb(181, 206, 168)">49500</span><span class="token plain"> -e </span><span class="token number" style="color:rgb(181, 206, 168)">99500</span><span class="token plain"> -c </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"> -i </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain"> -rs </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"> -rr </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Test Program A</strong> collects message integrity and latency statistics:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -lgr </span><span class="token number" style="color:rgb(181, 206, 168)">0.8</span><span class="token plain"> -imf -crg -ckgn -ckcon -sem -ckmsn -u </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"> -su </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> -lg </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> -cg </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> -cgm </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> -sm </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"> -gm </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>At this time, Test Program A is deployed on Server 2&#x27;s shared memory <code>/dev/shm</code>, and Test Program B is deployed on Server 1.</p></li></ul><table><thead><tr><th>Parameter/Result</th><th>Description</th></tr></thead><tbody><tr><td><strong>Stress Scenario</strong></td><td>50,000 users online, sending approximately 1,700 messages per second</td></tr><tr><td><strong>Sampled User Count</strong></td><td>100 users, with 80 logging in immediately and 20 logging in with delay</td></tr><tr><td><strong>Number and Size of Groups for Sampled Users</strong></td><td>Each user joins 0-20 regular groups, each group has 5 members</td></tr><tr><td><strong>Message Sending Frequency for Sampled Users</strong></td><td>Peak of 160 messages/s</td></tr><tr><td><strong>Number of Messages in Sample Statistics</strong></td><td>170,800</td></tr><tr><td><strong>Message Integrity in Sample Statistics</strong></td><td>100% (All messages accurately delivered)</td></tr><tr><td><strong>Average Message Latency in Sample Statistics</strong></td><td>0.202 seconds</td></tr><tr><td><strong>Maximum Message Latency in Sample Statistics</strong></td><td>3.641 seconds</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="test-3-50000-online-users--50000-large-groups">Test 3: 50,000 Online Users + 50,000 Large Groups<a href="#test-3-50000-online-users--50000-large-groups" class="hash-link" aria-label="Direct link to Test 3: 50,000 Online Users + 50,000 Large Groups" title="Direct link to Test 3: 50,000 Online Users + 50,000 Large Groups">​</a></h4><ul><li><p><strong>Test Program B</strong>: Simulates 50,000 online users, randomly sending messages.</p></li><li><p><strong>Test Program A</strong>: Simulates 20 users, with 16 logging in immediately and sending messages to 10 large groups of 50,000 users and friends.</p></li><li><p><strong>Test Program A</strong> registers 100,000 users:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -reg -u </span><span class="token number" style="color:rgb(181, 206, 168)">100000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Test Program B</strong> starts 50,000 online users:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -o </span><span class="token number" style="color:rgb(181, 206, 168)">50000</span><span class="token plain"> -s </span><span class="token number" style="color:rgb(181, 206, 168)">49500</span><span class="token plain"> -e </span><span class="token number" style="color:rgb(181, 206, 168)">99500</span><span class="token plain"> -c </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"> -i </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain"> -rs </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"> -rr </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Test Program A</strong> collects message integrity and latency statistics:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -lgr </span><span class="token number" style="color:rgb(181, 206, 168)">0.8</span><span class="token plain"> -imf -crg -ckgn -ckcon -sem -ckmsn -u </span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token plain"> -su </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> -lg </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> -cg </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> -cgm </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> -sm </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> -gm </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>At this time, Test Program A is deployed on Server 2&#x27;s shared memory <code>/dev/shm</code>, and Test Program B is deployed on Server 1.</p></li></ul><table><thead><tr><th>Parameter/Result</th><th>Description</th></tr></thead><tbody><tr><td><strong>Stress Scenario</strong></td><td>50,000 users online, sending approximately 1,700 messages per second</td></tr><tr><td><strong>Sampled User Count</strong></td><td>20 users, with 16 logging in immediately and 4 logging in with delay</td></tr><tr><td><strong>Number and Size of Groups for Sampled Users</strong></td><td>10 large groups, each with 50,000 members, 500 online</td></tr><tr><td><strong>Message Sending Frequency for Sampled Users</strong></td><td>Peak of 32 messages/s</td></tr><tr><td><strong>Number of Messages in Sample Statistics</strong></td><td>24,000</td></tr><tr><td><strong>Message Integrity in Sample Statistics</strong></td><td>100% (All messages accurately delivered)</td></tr><tr><td><strong>Average Message Latency in Sample Statistics</strong></td><td>0.022 seconds</td></tr><tr><td><strong>Maximum Message Latency in Sample Statistics</strong></td><td>1.664 seconds</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="test-2-server-resource-consumption">Test 2 Server Resource Consumption<a href="#test-2-server-resource-consumption" class="hash-link" aria-label="Direct link to Test 2 Server Resource Consumption" title="Direct link to Test 2 Server Resource Consumption">​</a></h4><p><strong>Number of Logged-in Users:</strong></p><img loading="lazy" src="/assets/images/br-login-3cd26e2e43f94a1539790a376dd2d1cb.png" alt="br-login" class="img_ev3q"><p><strong>Message Stress:</strong> (The following graph shows the number of messages received by the server per minute)</p><img loading="lazy" src="/assets/images/br-msg-d51a6833a292c607a9dc6cf81f9fd2da.png" alt="br-msg" class="img_ev3q"><p><strong>CPU Usage:</strong></p><img loading="lazy" src="/assets/images/br-cpu-9aa4d9fb0f746ba56300844c9f6ee601.png" alt="br-cpu" class="img_ev3q"><table><thead><tr><th>Process</th><th>CPU Usage</th></tr></thead><tbody><tr><td>openim-msggateway</td><td>210%</td></tr><tr><td>mongo</td><td>100%</td></tr><tr><td>kafka</td><td>84%</td></tr><tr><td>redis</td><td>67%</td></tr><tr><td>openim-rpc-msg</td><td>56%</td></tr><tr><td>openim-msgtransfer</td><td>27%*8</td></tr><tr><td>openim-push</td><td>13%*8</td></tr><tr><td>Other <code>OpenIM</code> services and components</td><td>65%</td></tr><tr><td><strong>Total</strong></td><td><strong>902%</strong></td></tr></tbody></table><p><strong>Physical Memory Usage:</strong></p><img loading="lazy" src="/assets/images/br-mem-23ddfb9ac9d3682c7f7ccc76eb1ffb1c.png" alt="br-mem" class="img_ev3q"><table><thead><tr><th>Process</th><th>Memory Usage</th></tr></thead><tbody><tr><td>openim-msggateway</td><td>2.1 GiB</td></tr><tr><td>mongo</td><td>717 MiB</td></tr><tr><td>kafka</td><td>1.1 GiB</td></tr><tr><td>redis</td><td>85 MiB</td></tr><tr><td>openim-rpc-msg</td><td>162 MiB</td></tr><tr><td>openim-msgtransfer</td><td>74 MiB*8</td></tr><tr><td>openim-push</td><td>126 MiB*8</td></tr><tr><td>Other <code>OpenIM</code> services and components</td><td>457 MiB</td></tr><tr><td><strong>Total (All <code>OpenIM</code> Services and Components)</strong></td><td><strong>6.986 GiB</strong></td></tr></tbody></table><p><em>Note: The table contents are rough estimates and do not include the resource consumption of Docker forwarding data to containers in the total. For reference only.</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="result-analysis"><strong>Result Analysis</strong><a href="#result-analysis" class="hash-link" aria-label="Direct link to result-analysis" title="Direct link to result-analysis">​</a></h3><p>OpenIM supports 50,000 concurrent online users and can handle multiple super groups of 50,000 users each. Under the pressure of approximately 1,700 messages per second, the message delivery rate reaches 100%. The average message latency is below 1 second, and the maximum latency does not exceed 3 seconds, demonstrating excellent performance and reliability.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-recommendations"><strong>Configuration Recommendations</strong><a href="#configuration-recommendations" class="hash-link" aria-label="Direct link to configuration-recommendations" title="Direct link to configuration-recommendations">​</a></h4><p>Based on 100,000 registered users, with 10% online daily, supporting super groups of 50,000 users, and handling 600 messages per second, the recommended configuration is:</p><table><thead><tr><th>Name</th><th>Configuration</th></tr></thead><tbody><tr><td>Memory</td><td>16 GB</td></tr><tr><td>CPU</td><td>8 cores</td></tr><tr><td>Network Bandwidth</td><td>10 Mbps</td></tr></tbody></table><p><em>Note: The message packet size is calculated at 2KB. The actual message packet size varies based on the content sent. A typical text message is approximately 700 bytes.</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-information"><strong>Additional Information</strong><a href="#additional-information" class="hash-link" aria-label="Direct link to additional-information" title="Direct link to additional-information">​</a></h3><p>This test utilized two testing programs:</p><ul><li><p><strong>Stress Test Program</strong>: Path: <code>openim-sdk-core/msgtest/</code></p></li><li><p><strong>Reliability Test Program</strong>: Path: <code>openim-sdk-core/integration_test/</code></p></li></ul><p>Below are the usage instructions for the reliability test program and explanations of the detection logic.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parameter-descriptions"><strong>Parameter Descriptions</strong><a href="#parameter-descriptions" class="hash-link" aria-label="Direct link to parameter-descriptions" title="Direct link to parameter-descriptions">​</a></h4><p>The testing program supports specifying different test scenarios through configuration parameters. By flexibly setting parameters, users can freely simulate various complex scenarios, covering different network states and operation processes, thereby more accurately assessing the reliability of the message channel.</p><table><thead><tr><th>Parameter</th><th>Meaning</th><th>Type</th></tr></thead><tbody><tr><td>u</td><td>Number of users</td><td>int</td></tr><tr><td>su</td><td>Number of users with all friends</td><td>int</td></tr><tr><td>lg</td><td>Number of large groups</td><td>int</td></tr><tr><td>lgm</td><td>Number of members in large groups</td><td>int</td></tr><tr><td>cg</td><td>Number of regular groups each user creates</td><td>int</td></tr><tr><td>cgm</td><td>Number of members in regular groups</td><td>int</td></tr><tr><td>sm</td><td>Number of private messages each user sends</td><td>int</td></tr><tr><td>gm</td><td>Number of group messages each user sends</td><td>int</td></tr><tr><td>reg</td><td>Whether to register users</td><td>bool</td></tr><tr><td>imf</td><td>Whether to import friends</td><td>bool</td></tr><tr><td>crg</td><td>Whether to create groups</td><td>bool</td></tr><tr><td>sem</td><td>Whether to send messages</td><td>bool</td></tr><tr><td>ckgn</td><td>Whether to check the number of groups</td><td>bool</td></tr><tr><td>ckcon</td><td>Whether to check the number of conversations</td><td>bool</td></tr><tr><td>ckmsn</td><td>Whether to check the number of messages</td><td>bool</td></tr><tr><td>ckuni</td><td>Whether to simulate uninstall and reinstall and check again</td><td>bool</td></tr><tr><td>lgr</td><td>User login ratio/login rate</td><td>float</td></tr></tbody></table><p>Below is an example of a run command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">go run main.go -u </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> -su </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> -lg </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> -cg </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> -cgm </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> -sm </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token plain"> -gm </span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token plain"> -reg -lgr </span><span class="token number" style="color:rgb(181, 206, 168)">0.7</span><span class="token plain"> -imf -crg -ckgn -ckcon -sem -ckmsn -ckuni</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The meanings of the command parameters are as follows:</p><ul><li><code>-u 10</code>: Create a total of 10 users</li><li><code>-su 3</code>: Create 3 super users</li><li><code>-lg 2</code>: Create 2 large group chats</li><li><code>-cg 4</code>: Each logged-in user creates 4 small group chats</li><li><code>-cgm 5</code>: Each small group chat contains 5 members</li><li><code>-sm 6</code>: Send 6 private messages</li><li><code>-gm 7</code>: Send 7 group messages</li><li><code>-reg</code>: Execute user registration</li><li><code>-lgr 0.7</code>: 70% of users log in</li><li><code>-imf</code>: Import friends</li><li><code>-crg</code>: Create group chats</li><li><code>-ckgn</code>: Check the number of group chats</li><li><code>-ckcon</code>: Check the number of conversations</li><li><code>-sem</code>: Send messages</li><li><code>-ckmsn</code>: Check the number of messages</li><li><code>-ckuni</code>: Simulate uninstall and reinstall operations</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-file-description"><strong>Configuration File Description</strong><a href="#configuration-file-description" class="hash-link" aria-label="Direct link to configuration-file-description" title="Direct link to configuration-file-description">​</a></h4><p>The configuration file is located in the <code>internal/config/</code> directory. The basic configuration file is <code>config.go</code>, configured as follows:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">    TestIP              </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;127.0.0.1&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// IP address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    APIAddr            </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;http://&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> TestIP </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;:10002&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    WsAddr             </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ws://&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> TestIP </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;:10001&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    AdminUserID        </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;imAdmin&quot;</span><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Server administrator ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Secret             </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;openIM123&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Server administrator password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    PlatformID         </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> constant</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">WindowsPlatformID </span><span class="token comment" style="color:rgb(106, 153, 85)">// Simulated login platform type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    LogLevel           </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Log level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    DataDir            </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;./data/&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Data file path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    LogFilePath        </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;./logs/&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Log file path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    IsLogStandardOutput </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Whether to output logs to the console, recommended false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-plan"><strong>Implementation Plan</strong><a href="#implementation-plan" class="hash-link" aria-label="Direct link to implementation-plan" title="Direct link to implementation-plan">​</a></h4><p>The core operations of the testing program can be divided into two categories: <strong>simulation operations</strong> and <strong>detection operations</strong>. Simulation operations are used to mimic user behaviors in real scenarios, such as registration, login, and message sending. Since simulation operations involve asynchronous execution, detection operations are performed to ensure that all operations complete successfully and verify the correctness of the results. For example, during the login process, it is essential to ensure that each client successfully connects to the server before proceeding to subsequent operations. At this point, detecting the number of logged-in users is particularly important.</p><p>The detection operations serve two main purposes:</p><ol><li><strong>Block the main process</strong>: Ensure that all asynchronous simulation operations have completed.</li><li><strong>Verify result accuracy</strong>: Use a series of correctness checks to verify whether the simulation operations achieved the expected results.</li></ol><p>Currently, the following detection operations are included:</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="user-login-detection"><strong>User Login Detection</strong><a href="#user-login-detection" class="hash-link" aria-label="Direct link to user-login-detection" title="Direct link to user-login-detection">​</a></h5><p>User login detection occurs after <strong>initialization or registration</strong>, as well as before each <strong>correctness detection operation</strong>. It involves calculating the actual number of users successfully connected to the server and comparing it to the expected number of logged-in users.</p><p>Expected number of users logged in:</p><ol><li><code>Total number of users * login rate</code>, rounded down.</li><li>Total number of users.</li></ol><h5 class="anchor anchorWithStickyNavbar_LWe7" id="friend-count-detection"><strong>Friend Count Detection</strong><a href="#friend-count-detection" class="hash-link" aria-label="Direct link to friend-count-detection" title="Direct link to friend-count-detection">​</a></h5><p>Friend count detection is performed after the friend import operation completes. Since offline users cannot synchronize data, this detection only verifies the number of friends for online users.</p><p>The actual number of friends is obtained by calling the corresponding SDK. The expected number of friends is as follows:</p><ul><li><strong>Super Users</strong>: Should have all users as friends.</li><li><strong>Regular Users</strong>: Should have all super users as friends.</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="group-chat-count-detection"><strong>Group Chat Count Detection</strong><a href="#group-chat-count-detection" class="hash-link" aria-label="Direct link to group-chat-count-detection" title="Direct link to group-chat-count-detection">​</a></h5><p>Group chat count detection is part of correctness detection operations and involves calling the SDK to obtain the actual number of group chats.</p><p>Expected number of group chats:</p><ul><li>Number of large groups + number of regular groups (the number of regular groups may vary depending on user login status).</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="conversation-count-detection"><strong>Conversation Count Detection</strong><a href="#conversation-count-detection" class="hash-link" aria-label="Direct link to conversation-count-detection" title="Direct link to conversation-count-detection">​</a></h5><p>Conversation count detection is also part of correctness detection and involves calling the SDK to obtain the actual number of conversations.</p><p>Expected number of conversations:</p><ul><li>Number of all group chat conversations + number of all friend conversations.</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="unread-message-count-detection"><strong>Unread Message Count Detection</strong><a href="#unread-message-count-detection" class="hash-link" aria-label="Direct link to unread-message-count-detection" title="Direct link to unread-message-count-detection">​</a></h5><p>Unread message count detection is also part of correctness detection. It involves calling the SDK to obtain the actual number of unread messages and comparing it with the expected value.</p><p>The expected number of unread messages is calculated as follows:</p><ul><li>All group notification messages + all group messages - (group notification messages created by oneself + group messages sent by oneself) + friend request approval notification messages + friend messages.</li></ul><p>It is important to note that only the initiator of a friend request will receive unread notification messages for approved friend requests. Additionally, based on the <strong>friend import</strong> operation logic, only super users will have a different number of notification messages.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="modification-of-limits"><strong>Modification of Limits</strong><a href="#modification-of-limits" class="hash-link" aria-label="Direct link to modification-of-limits" title="Direct link to modification-of-limits">​</a></h4><ul><li><p>During simulation operations, multiple SDK instances run simultaneously, which may put significant pressure on the server, potentially causing timeouts or other issues. To ensure the system runs smoothly during large-scale data testing, the following key parameters need to be adjusted:</p><ol><li><p><strong>Modify Request Timeout</strong></p><ul><li><strong>Location</strong>: <code>openim-sdk-core/pkg/network/http_client.go</code></li><li><strong>Adjustment</strong>: Appropriately extend the default request timeout to reduce request timeout issues under large data volumes. It is recommended to configure reasonably based on the test scale and actual network conditions.</li></ul></li><li><p><strong>Set Notification Messages to Unread Status</strong></p><ul><li><strong>Location</strong>: <code>open-im-server/config/notification.yml</code></li><li><strong>Adjustment</strong>: Set the <code>unreadCount</code> parameter for <code>groupCreated</code> and <code>friendApplicationApproved</code> to <code>true</code>. This configuration ensures that when online users receive group creation and friend request approval notification messages, they are still marked as unread messages, facilitating subsequent unread message count calculations.</li></ul></li><li><p><strong>Increase Maximum File Descriptor Count</strong></p><ul><li><strong>Location</strong>: <code>open-im-server/start-config.yml</code></li><li><strong>Adjustment</strong>: Appropriately increase the <code>maxFileDescriptors</code> value based on the number of users that need to log in during testing.</li></ul></li></ol></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/OpenIMSDK/docs/tree/main/docs/guides/benchmark_test.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-04-17T11:13:50.000Z">Apr 17, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/guides/solution/s3convert"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">如何迁移到其他S3存储</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#reliability-and-latency" class="table-of-contents__link toc-highlight">Reliability and Latency</a><ul><li><a href="#testing-resources" class="table-of-contents__link toc-highlight"><strong>Testing Resources</strong></a></li><li><a href="#test-scenarios-and-results" class="table-of-contents__link toc-highlight"><strong>Test Scenarios and Results</strong></a></li><li><a href="#result-analysis" class="table-of-contents__link toc-highlight"><strong>Result Analysis</strong></a></li><li><a href="#additional-information" class="table-of-contents__link toc-highlight"><strong>Additional Information</strong></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container-fluid container"><div class="margin-bottom--sm"><a class="footerLogoLink_DDai" href="/"><img src="/logo/light.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--light_HNdA footer__logo" height="38px"><img src="/logo/dark.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" height="38px"></a></div><p class="footer__description">OpenIM is an open source instant messaging component built by IM technical experts. OpenIM includes IM server and client SDK, which realizes important features such as high performance, light weight, and easy expansion. By integrating OpenIM components and privatizing the deployment of the server, developers can quickly integrate instant messaging and real-time network capabilities into their own applications, and ensure the security and privacy of business data.</p><div class="footer__row"><div class="footer__data"><div class="footer__cta"><p>Join the Slack channel to communicate and discuss with everyone!</p><a href="https://join.slack.com/t/openimsdk/shared_invite/zt-2hljfom5u-9ZuzP3NfEKW~BJKbpLm0Hw" target="_blank" rel="noopener noreferrer">Join</a></div></div><div class="links"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openim.io/commercial" target="_blank" rel="noopener noreferrer" class="footer__link-item">Business</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openim.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Us</a></li><li class="footer__item"><a href="mailto:contact@openim.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/guides/introduction">Documentation</a></li><li class="footer__item"><a href="https://join.slack.com/t/openimsdk/shared_invite/zt-2hljfom5u-9ZuzP3NfEKW~BJKbpLm0Hw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community</a></li></ul></div></div></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © OpenIM since 2023. All rights reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fdeac86e.js"></script>
<script src="/assets/js/main.081581e0.js"></script>
</body>
</html>