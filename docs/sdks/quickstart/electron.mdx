---
title: Electron
hide_title: true
sidebar_position: 6
---


## ğŸš€ä½¿ç”¨ Demo
æˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨é¦–å…ˆè¿è¡Œæˆ‘ä»¬ä¸ºæ‚¨å‡†å¤‡çš„æ¡†æ¶ç›¸å…³çš„ç¤ºä¾‹ [DEMO](https://github.com/openimsdk/openim-electron-demo) (feat-electron-ffiåˆ†æ”¯)ã€‚è¿™ä¸ä»…å¯ä»¥è®©æ‚¨ç›´è§‚ä½“éªŒ OpenIM SDK çš„åŠŸèƒ½ï¼Œè¿˜å°†å¸®åŠ©æ‚¨åœ¨å®é™…é›†æˆè¿‡ç¨‹ä¸­è¿…é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚


## å¿«é€Ÿé›†æˆ

### 1. æ·»åŠ ä¾èµ–

```shell
npm install open-im-sdk-wasm @openim/electron-client-sdk --save
```

### 2. è·å– wasm æ‰€éœ€é™æ€èµ„æº

> åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„`node_modules`ç›®å½•ä¸‹æ‰¾åˆ°`open-im-sdk-wasm`å­ç›®å½•ï¼Œå°†å…¶ä¸­`assets`æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°é¡¹ç›®å…¬å…±èµ„æºç›®å½•ä¸­ï¼ˆpublicï¼‰ã€‚

- æ–‡ä»¶æ¸…å•

```bash
openIM.wasm
sql-wasm.wasm
wasm_exec.js
```

- æ‹·è´å®Œæˆååœ¨æ‚¨çš„`index.html`æ–‡ä»¶ä¸­é€šè¿‡ script æ ‡ç­¾å¼•å…¥`wasm_exec.js`æ–‡ä»¶

- å¯èƒ½å­˜åœ¨çš„é—®é¢˜
  > å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨webpack4ï¼Œå¯èƒ½éœ€è¦å‚è€ƒè¿™ä¸ªissueæ¥è¿›è¡Œé…ç½®[How to import open-im-sdk-wasm in webpack4.x](https://github.com/openimsdk/open-im-sdk-web-wasm/issues/73)

### 3. å¼•å…¥ SDK

- ä¸»è¿›ç¨‹

```typescript
import OpenIMSDKMain from '@openim/electron-client-sdk';

...
new OpenIMSDKMain(libPath, mainWindow.webContents);
...
```

- preloadè„šæœ¬

```typescript
import '@openim/electron-client-sdk/lib/preload';

...
```

- æ¸²æŸ“è¿›ç¨‹

```typescript
import { getWithRenderProcess } from '@openim/electron-client-sdk/lib/render';

const { instance } = getWithRenderProcess();

export const IMSDK = instance;
```

### 4. ç™»å½•ã€è®¾ç½®ç›‘å¬
> æ³¨æ„ï¼šåœ¨electronå’Œwebç¯å¢ƒä¸‹ï¼Œåˆå§‹åŒ–SDKçš„æ–¹å¼æœ‰æ‰€ä¸åŒã€‚å¦‚æœéœ€è¦åŒæ—¶æ”¯æŒelectronå’Œwebï¼Œéœ€è¦æ³¨æ„åˆ†åˆ«å¤„ç†ã€‚

```typescript
import { CbEvents, LogLevel } from 'open-im-sdk-wasm';
import type { WSEvent } from 'open-im-sdk-wasm/lib/types/entity';

IMSDK.on(CbEvents.OnConnecting, handleConnecting);
IMSDK.on(CbEvents.OnConnectFailed, handleConnectFailed);
IMSDK.on(CbEvents.OnConnectSuccess, handleConnectSuccess);

// electron
await IMSDK.initSDK({
  platformID: 'your-platform-id',
  apiAddr: 'http://your-server-ip:10002',
  wsAddr: 'ws://your-server-ip:10001',
  dataDir: 'your-db-dir',
  logFilePath: 'your-log-file-path',
  logLevel: LogLevel.Debug,
  isLogStandardOutput: true,
});

await IMSDK.login({
  userID: 'your-user-id',
  token: 'your-token',
});

// web
await IMSDK.login({
  userID: 'your-user-id',
  token: 'your-token',
  platformID: 5,
  apiAddr: 'http://your-server-ip:10002',
  wsAddr: 'ws://your-server-ip:10001',
  logLevel: LogLevel.Debug,
});

function handleConnecting() {
  // Connecting...
}

function handleConnectFailed({ errCode, errMsg }: WSEvent) {
  // Connection failed âŒ
  console.log(errCode, errMsg);
}

function handleConnectSuccess() {
  // Connection successful âœ…
}
```

### 5. æ”¶å‘æ¶ˆæ¯

```typescript
import { CbEvents } from 'open-im-sdk-wasm';
import type { WSEvent, MessageItem } from 'open-im-sdk-wasm/lib/types/entity';

// Listenfor new messages ğŸ“©
IMSDK.on(CbEvents.OnRecvNewMessages, handleNewMessages);

const message = (await IMSDK.createTextMessage('hello openim')).data;

IMSDK.sendMessage({
  recvID: 'recv user id',
  groupID: '',
  message,
})
  .then(() => {
    // Message sent successfully âœ‰ï¸
  })
  .catch(err => {
    // Failed to send message âŒ
    console.log(err);
  });

function handleNewMessages({ data }: WSEvent<MessageItem[]>) {
  // New message list ğŸ“¨
  console.log(data);
}
```