<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-guides docs-doc-id-gettingStarted/admin">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Monitoring and Alert System | OpenIM Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.rentsoft.cn/guides/gettingStarted/admin"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-guides-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-guides-current"><meta data-rh="true" property="og:title" content="Monitoring and Alert System | OpenIM Docs"><meta data-rh="true" name="description" content="Component Description"><meta data-rh="true" property="og:description" content="Component Description"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.rentsoft.cn/guides/gettingStarted/admin"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/zh-Hans/guides/gettingStarted/admin" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/guides/gettingStarted/admin" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://doc.rentsoft.cn/guides/gettingStarted/admin" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NRY7H605ZD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="OpenIM Docs" href="/opensearch.xml">





<script src="/embed.js"></script><link rel="stylesheet" href="/assets/css/styles.c2eae4fa.css">
<link rel="preload" href="/assets/js/runtime~main.40cbd575.js" as="script">
<link rel="preload" href="/assets/js/main.e44b18e5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo/light.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--light_HNdA logo-icon" width="107.5px"><img src="/logo/dark.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--dark_i4oU logo-icon" width="107.5px"></div></a><a class="navbar__item navbar__link" href="/guides/introduction">Guides</a><a class="navbar__item navbar__link" href="/sdks/introduction">Client SDKs</a><a class="navbar__item navbar__link" href="/restapi/apis/introduction">Server APIs</a><a class="navbar__item navbar__link" href="/blog/introduction">Blog</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="relative flex items-center gap-2"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search" id="search-bar"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><a href="https://github.com/OpenIMSDK" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link dev-portal-signup dev-portal-link header-github-link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/zh-Hans/guides/gettingStarted/admin" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li><li><a href="/guides/gettingStarted/admin" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/guides/introduction">OpenIM</a><button aria-label="Toggle the collapsible sidebar category &#x27;OpenIM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/guides/gettingStarted/imSourceCodeDeployment">快速部署</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/imSourceCodeDeployment">Source Code Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/quickTestServer">Quick Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/internalDeployment">内网部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/k8s-deployment">k8s Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/gettingStarted/admin">Monitoring and Alert System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/cluster">Cluster Deployment Instructions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/env-comp">Environment and Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/arm">arm架构部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/config-center">配置中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/faultRecovery">单机生产环境异常处理及数据恢复</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/faq">常见问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/dockerCompose">Docker Deployment for OpenIM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/gettingStarted/nginxDomainConfig">Nginx Domain Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/guides/pressure_test">Stress Test Report</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/guides/solution/offlinePush">解决方案</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/guides/benchmark_test">Stress and Reliability Test Report</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Monitoring and Alert System</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="component-description">Component Description<a href="#component-description" class="hash-link" aria-label="Direct link to Component Description" title="Direct link to Component Description">​</a></h2><p>When deploying with Docker Compose, the following components will be automatically deployed. For source code deployment, these components must be manually enabled in docker-compose.yaml.</p><table><thead><tr><th>Component Name</th><th>Description</th><th>Deployment Instructions</th></tr></thead><tbody><tr><td>openim-admin</td><td>Admin backend providing a monitoring page entry.</td><td>Automatically enabled in Docker and source code deployments.</td></tr><tr><td>prometheus</td><td>Monitoring system component for collecting and storing metric data.</td><td>Automatically enabled in Docker deployments; manual enablement required for source code deployments.</td></tr><tr><td>alertmanager</td><td>Component for managing and sending alerts.</td><td>Automatically enabled in Docker deployments; manual enablement required for source code deployments.</td></tr><tr><td>grafana</td><td>Dashboard component for displaying monitoring data.</td><td>Automatically enabled in Docker deployments; manual enablement required for source code deployments.</td></tr><tr><td>node-exporter</td><td>Collects node (e.g., server) metric information.</td><td>Automatically enabled in Docker deployments; manual enablement required for source code deployments.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-file-description">Configuration File Description<a href="#configuration-file-description" class="hash-link" aria-label="Direct link to Configuration File Description" title="Direct link to Configuration File Description">​</a></h2><table><thead><tr><th>File Name</th><th>File Description</th><th>Modification Items</th></tr></thead><tbody><tr><td>config/config.yaml</td><td>OpenIM service configuration</td><td>prometheus.enable: true indicates enabling</td></tr><tr><td>config/prometheus.yml</td><td>Prometheus configuration</td><td>No modifications required</td></tr><tr><td>config/instance-down-rules.yml</td><td>Alert rules</td><td>Two default rules configured (instance_down, database_insert_failure_alerts)</td></tr><tr><td>config/alertmanager.yml</td><td>Alert management configuration</td><td>Sender and recipient email information must be configured</td></tr><tr><td>config/email.tmpl</td><td>Email alert template</td><td>Default email template, modifiable</td></tr><tr><td>config/templates/prometheus-dashboard.yaml</td><td>Custom dashboard</td><td>No modifications required</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="logging-into-the-admin-backend">Logging into the Admin Backend<a href="#logging-into-the-admin-backend" class="hash-link" aria-label="Direct link to Logging into the Admin Backend" title="Direct link to Logging into the Admin Backend">​</a></h2><p>Enter <code>http://ip:11002</code> in the browser to access the admin backend. This IP is the server OPENIM_IP; ensure your browser can access it. The default username and password are both chatAdmin.</p><img loading="lazy" src="/assets/images/admin-a8f308c39b20d55e0c99886a1848349a.jpg" width="700" alt="admin" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="logging-into-grafana">Logging into Grafana<a href="#logging-into-grafana" class="hash-link" aria-label="Direct link to Logging into Grafana" title="Direct link to Logging into Grafana">​</a></h2><p>First, log into the admin backend, then click the data monitoring menu on the left, enter the default username (admin) and password (admin) to log into Grafana.</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/login1-278e0f0b8e78be0dedab061ee7a60ab0.png" width="1920" height="868" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-prometheus-data-source">Adding Prometheus Data Source<a href="#adding-prometheus-data-source" class="hash-link" aria-label="Direct link to Adding Prometheus Data Source" title="Direct link to Adding Prometheus Data Source">​</a></h2><p>As shown below, enter the URL of the Prometheus data source: <a href="http://172.28.0.1:19090" target="_blank" rel="noopener noreferrer">http://172.28.0.1:19090</a> (19090 is the default Prometheus port) and click &quot;Save and Test&quot; to save.</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/database-8ebb85b286a5e7509f08fc18aadac189.png" width="2880" height="1397" class="img_ev3q"></p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/database2-6dc1ae4114d3282c1de06e2dcbd176e4.png" width="2856" height="1434" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="importing-a-custom-dashboard">Importing a Custom Dashboard<a href="#importing-a-custom-dashboard" class="hash-link" aria-label="Direct link to Importing a Custom Dashboard" title="Direct link to Importing a Custom Dashboard">​</a></h2><p>Click the import button as shown below to import the dashboard.</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/dashboard-bab5c385a6dbac9f919f494a94e2a49a.png" width="1917" height="714" class="img_ev3q"></p><p>Copy the content from <a href="https://github.com/openimsdk/open-im-server/tree/main/config/templates/prometheus-dashboard.yaml" target="_blank" rel="noopener noreferrer">https://github.com/openimsdk/open-im-server/tree/main/config/templates/prometheus-dashboard.yaml</a> into the area shown below, then click the load button.</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/dashboard2-249cfe565b44bbf0eb8924889d858248.png" width="1512" height="853" class="img_ev3q"></p><p>Select your Data Source and job, customize metric information as shown below.</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/dashboard3-277e7f05ed345b5b6c869324aec5d34f.png" width="1912" height="860" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="importing-node-exporters-dashboard">Importing node-exporter&#x27;s Dashboard<a href="#importing-node-exporters-dashboard" class="hash-link" aria-label="Direct link to Importing node-exporter&#x27;s Dashboard" title="Direct link to Importing node-exporter&#x27;s Dashboard">​</a></h2><p>Enter 1860 to import, or find other node-exporter dashboard views on the official website (<a href="https://grafana.com/grafana/dashboards/" target="_blank" rel="noopener noreferrer">https://grafana.com/grafana/dashboards/</a>).</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/dashboard4-f79d3516a843e6b86da396a9744beb7d.png" width="1120" height="790" class="img_ev3q"></p><p>node-exporter metric information, as shown below.</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/dashboard5-9db1fd21b30ff25567bb80788c0e8071.png" width="1913" height="793" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alert-configuration-file-explanation">Alert Configuration File Explanation<a href="#alert-configuration-file-explanation" class="hash-link" aria-label="Direct link to Alert Configuration File Explanation" title="Direct link to Alert Configuration File Explanation">​</a></h2><ol><li><p><strong>Email Alert Architecture Diagram</strong>: The Prometheus component loads the <code>instance-down-rules.yml</code> file for alert rules, sending qualifying alert information to the Alertmanager component. Alertmanager loads the <code>alertmanager.yml</code> and <code>email.tmpl</code> files, sending emails using configured alert email information and templates.
<img loading="lazy" alt="PC Web Interface" src="/assets/images/alert2-d82df995fc7f9cf2a8462a6ed18bab5a.png" width="1086" height="304" class="img_ev3q"></p></li><li><p><strong>prometheus.yml File Explanation</strong>: Mainly used to configure the path of the alert rules file, alert management service address, and IP addresses for monitoring data capture. Default settings usually require no modification.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Alertmanager configuration</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">alerting:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">alertmanagers:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">- static_configs:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">- targets: [&#x27;172.28.0.1:19093&#x27;]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"># Load rules once and periodically evaluate them according to the global &#x27;evaluation_interval&#x27;.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">rule_files:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  - &quot;instance-down-rules.yml&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>instance-down-rules.yaml File Explanation</strong>: By default, two email alert rules are implemented (instance_down, database_insert_failure_alerts). To add more alert rules, they can be included in the <code>instance-down-rules.yml</code> file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">groups:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">- name: instance_down  # Alert Rule One: Triggers if a monitoring module crashes for over a minute</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  rules:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    - alert: InstanceDown</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      expr: up == 0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      for: 1m</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        severity: critical</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      annotations:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        summary: &quot;Instance {{ $labels.instance }} down&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        description: &quot;{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 1 minutes.&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">- name: database_insert_failure_alerts # Alert Rule Two: Triggers if there&#x27;s an increase in msg_insert_redis_failed_total and msg_insert_mongo_failed_total</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  rules:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    - alert: DatabaseInsertFailed</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      expr: (increase(msg_insert_redis_failed_total[5m]) &gt; 0) or (increase(msg_insert_mongo_failed_total[5m]) &gt; 0)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      for: 1m</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        severity: critical</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      annotations:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        summary: &quot;Increase in MsgInsertRedisFailedCounter or MsgInsertMongoFailedCounter detected&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        description: &quot;Either MsgInsertRedisFailedCounter or MsgInsertMongoFailedCounter has increased in the last 5 minutes, indicating failures in message insert operations to Redis or MongoDB, maybe the redis or mongodb is crash.&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>alertmanager.yml File Explanation</strong>: Modify the sender and receiver email configuration information to receive alert messages. To implement alerts through DingTalk, WeChat Work, or other means, you need to rewrite <code>alertmanager.yml</code>. Official documentation for the alert management module can be referred to here: <a href="https://prometheus.io/docs/alerting/latest/alertmanager/" target="_blank" rel="noopener noreferrer">https://prometheus.io/docs/alerting/latest/alertmanager/</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">global:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  resolve_timeout: 5m</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  smtp_from: alert@openim.io # Alert sending email</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  smtp_smarthost: smtp.163.com:465 # SMTP address for sending email</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  smtp_auth_username: alert@openim.io # Email authorization username, usually same as smtp_from</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  smtp_auth_password: YOURAUTHPASSWORD # Email authorization code</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  smtp_require_tls: false</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  smtp_hello: openim alert</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">templates:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  - /etc/alertmanager/email.tmpl # Email template</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">route:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  group_by: [&#x27;alertname&#x27;]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  group_wait: 5s</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  group_interval: 5s</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  repeat_interval: 5m</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  receiver: email</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">receivers:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  - name: email</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    email_configs:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      - to: &#x27;alert@example.com&#x27; # Receiving alert email</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        html: &#x27;{{ template &quot;email.to.html&quot; . }}&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        headers: { Subject: &quot;[OPENIM-SERVER]Alarm&quot; }# Email title</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        send_resolved: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><ol start="5"><li>Email Template File email.tmpl Explanation: This file is in HTML format. The alarm management module will fill in the variable information inside it, and then render it into an HTML format file for email sending. It can be rewritten according to your needs:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">{{ define &quot;email.to.html&quot; }}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{{ range .Alerts }}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;!-- Begin of OpenIM Alert --&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;div style=&quot;border:1px solid #ccc; padding:10px; margin-bottom:10px;&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;h3&gt;OpenIM Alert&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;p&gt;&lt;strong&gt;Alert Program:&lt;/strong&gt; Prometheus Alert&lt;/p&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;p&gt;&lt;strong&gt;Severity Level:&lt;/strong&gt; {{ .Labels.severity }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;p&gt;&lt;strong&gt;Alert Type:&lt;/strong&gt; {{ .Labels.alertname }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;p&gt;&lt;strong&gt;Affected Host:&lt;/strong&gt; {{ .Labels.instance }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;p&gt;&lt;strong&gt;Affected Service:&lt;/strong&gt; {{ .Labels.job }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;p&gt;&lt;strong&gt;Alert Subject:&lt;/strong&gt; {{ .Annotations.summary }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;p&gt;&lt;strong&gt;Trigger Time:&lt;/strong&gt; {{ .StartsAt.Format &quot;2006-01-02 15:04:05&quot; }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;/div&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;!-- End of OpenIM Alert --&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{{ end }}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{{ end }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alarm-experience">Alarm Experience<a href="#alarm-experience" class="hash-link" aria-label="Direct link to Alarm Experience" title="Direct link to Alarm Experience">​</a></h2><p>You can manually trigger the instancedown alarm rule. If you have deployed OpenIM from source code, execute the <code>make stop</code> command to stop the openim-server service. Wait for more than 5 minutes, and you will receive an alarm email as shown below:</p><p><img loading="lazy" alt="PC Web Interface" src="/assets/images/alert6-6524d6c82941769762152a11726c7834.png" width="775" height="682" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="logging-system">Logging System<a href="#logging-system" class="hash-link" aria-label="Direct link to Logging System" title="Direct link to Logging System">​</a></h2><p>If OpenIM service is deployed in a k8s environment using the helm chart method, you can view the logs of all OpenIM services through Grafana. Currently, binary and Docker deployments do not integrate the Loki logging collection component. To experience the Loki logging collection function, please use the helm chart deployment.
For more details, please visit <a href="https://github.com/openimsdk/helm-charts/blob/main/docs/user-guide-zh.md" target="_blank" rel="noopener noreferrer">https://github.com/openimsdk/helm-charts/blob/main/docs/user-guide-zh.md</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/OpenIMSDK/docs/tree/main/docs/guides/gettingStarted/admin.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-04-17T02:43:48.000Z">Apr 17, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/guides/gettingStarted/k8s-deployment"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">k8s Deployment</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/guides/gettingStarted/cluster"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cluster Deployment Instructions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#component-description" class="table-of-contents__link toc-highlight">Component Description</a></li><li><a href="#configuration-file-description" class="table-of-contents__link toc-highlight">Configuration File Description</a></li><li><a href="#logging-into-the-admin-backend" class="table-of-contents__link toc-highlight">Logging into the Admin Backend</a></li><li><a href="#logging-into-grafana" class="table-of-contents__link toc-highlight">Logging into Grafana</a></li><li><a href="#adding-prometheus-data-source" class="table-of-contents__link toc-highlight">Adding Prometheus Data Source</a></li><li><a href="#importing-a-custom-dashboard" class="table-of-contents__link toc-highlight">Importing a Custom Dashboard</a></li><li><a href="#importing-node-exporters-dashboard" class="table-of-contents__link toc-highlight">Importing node-exporter&#39;s Dashboard</a></li><li><a href="#alert-configuration-file-explanation" class="table-of-contents__link toc-highlight">Alert Configuration File Explanation</a></li><li><a href="#alarm-experience" class="table-of-contents__link toc-highlight">Alarm Experience</a></li><li><a href="#logging-system" class="table-of-contents__link toc-highlight">Logging System</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container-fluid container"><div class="margin-bottom--sm"><a class="footerLogoLink_DDai" href="/"><img src="/logo/light.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--light_HNdA footer__logo" height="38px"><img src="/logo/dark.png" alt="OpenIM Docs" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" height="38px"></a></div><p class="footer__description">OpenIM is an open source instant messaging component built by IM technical experts. OpenIM includes IM server and client SDK, which realizes important features such as high performance, light weight, and easy expansion. By integrating OpenIM components and privatizing the deployment of the server, developers can quickly integrate instant messaging and real-time network capabilities into their own applications, and ensure the security and privacy of business data.</p><div class="footer__row"><div class="footer__data"><div class="footer__cta"><p>Join the Slack channel to communicate and discuss with everyone!</p><a href="https://join.slack.com/t/openimsdk/shared_invite/zt-2hljfom5u-9ZuzP3NfEKW~BJKbpLm0Hw" target="_blank" rel="noopener noreferrer">Join</a></div></div><div class="links"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openim.io/commercial" target="_blank" rel="noopener noreferrer" class="footer__link-item">Business</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openim.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Us</a></li><li class="footer__item"><a href="mailto:contact@openim.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/guides/introduction">Documentation</a></li><li class="footer__item"><a href="https://join.slack.com/t/openimsdk/shared_invite/zt-2hljfom5u-9ZuzP3NfEKW~BJKbpLm0Hw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community</a></li></ul></div></div></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © OpenIM since 2023. All rights reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.40cbd575.js"></script>
<script src="/assets/js/main.e44b18e5.js"></script>
</body>
</html>