---
title: 'æºç éƒ¨ç½²'
sidebar_position: 1
---

# ğŸ›  æºç éƒ¨ç½²

## ğŸŒŸ ç¯å¢ƒè¦æ±‚

| **æ³¨æ„äº‹é¡¹** | **è¯¦ç»†è¯´æ˜**                                                  |
|------------|------------------------------------------------------------|
| æ“ä½œç³»ç»Ÿ     | linuxç³»ç»Ÿï¼ŒUbuntu 22.04æœ€ä¼˜ï¼Œrootç”¨æˆ·    |
| ç¡¬ä»¶èµ„æº     | è‡³å°‘4Gå¯ç”¨å†…å­˜ï¼Œå¯¹äºç”¨æˆ·é‡<10ä¸‡æ¨èå•æœºéƒ¨ç½² (8C 16G 10Mb 1T)  |
| Golang      | v1.19 æˆ–æ›´é«˜                                                   |
| Docker      | v24.0.5 æˆ–æ›´é«˜                                                 |
| Git         | v2.17.1 æˆ–æ›´é«˜                                                 |

## ğŸ“¦ å­˜å‚¨ç»„ä»¶è¦æ±‚

| **å­˜å‚¨ç»„ä»¶** | **å»ºè®®ç‰ˆæœ¬**  |
|:------------:|:-------------:|
| MongoDB      | v6.0.2+       |
| Redis        | v7.0.0+       |
| Zookeeper    | v3.8        |
| Kafka        | 3.5.1        |
| MySQL        | v5.7+         |
| MinIO        | æœ€æ–°ç‰ˆ        |

---

> ğŸ” **å¤‡æ³¨**: 
> 
> **OpenIMServer** æœ¬èº«å¹¶ä¸åŒ…å«è´¦å·æ³¨å†Œå’Œç™»å½•æœåŠ¡ã€‚ä¸ºäº†è®©å¼€å‘æ›´ä¸ºä¾¿æ·ï¼Œæˆ‘ä»¬å¯¹åŒ…å«ç™»å½•å’Œæ³¨å†ŒåŠŸèƒ½çš„ **AppServerï¼ˆchatï¼‰** è¿›è¡Œäº†å¼€æºã€‚åªéœ€éƒ¨ç½² **OpenIMServer** å’Œ **AppServerï¼ˆchatï¼‰**ï¼Œæ‚¨å°±å¯ä»¥æ­å»ºå‡ºä¸€ä¸ªå®Œæ•´çš„èŠå¤©äº§å“ã€‚



---




## ğŸŸ¢ ä¸€ã€éƒ¨ç½²ç»„ä»¶

### ğŸ“¦ 1. **å…‹éš†ä»“åº“å¹¶åˆ‡æ¢åˆ°å‘è¡Œåˆ†æ”¯**

```bash
git clone https://github.com/openimsdk/open-im-server && cd open-im-server 
```


###  ğŸŒ 2. è®¾ç½®å¸¸ç”¨ç¯å¢ƒå˜é‡

---

- **PASSWORD**
    - **æè¿°**: ç”¨äº mysql, mongodb, redis, minio çš„å¯†ç 
    - **é»˜è®¤å€¼**: `openIM123`
    - **æ³¨æ„äº‹é¡¹**:
      - å¯†ç é•¿åº¦è‡³å°‘ä¸º 8 ä¸ªå­—ç¬¦
      - ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦
    ```bash
    export PASSWORD="openIM123"
    ```

- **USER**
    - **æè¿°**: ç”¨äº mysql, mongodb, redis, minio çš„ç”¨æˆ·å
    - **é»˜è®¤å€¼**: `root`
    ```bash
    export USER="root"
    ```

- **OPENIM_IP**
    - **æè¿°**: API åœ°å€
    - **è¯´æ˜**: è‹¥æœåŠ¡å™¨æœ‰å¤–ç½‘ IPï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è·å–ã€‚è‹¥ä¸ºå†…ç½‘ï¼Œéœ€è®¾å®šæ­¤ç¯å¢ƒå˜é‡ä¸ºå¯¹å†…æœåŠ¡çš„ IPã€‚(ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦è®¾ç½®ï¼‰
    ```bash
    export OPENIM_IP="http://ip:10002"
    ```

- **DATA_DIR**
    - **æè¿°**: ç»„ä»¶æ•°æ®æŒ‚è½½ç›®å½•
    - **é»˜è®¤å€¼**: `./`
    ```bash
    export DATA_DIR="./"
    ```

- **PROMETHEUS_ENABLE**

  - **Description**: Flag to enable Prometheus
  - **Default Value**: `false`

  ```bash
  export PROMETHEUS_ENABLE=true
  ```
> + **Description**: Detailed documentation and reference for deploying and configuring Prometheus and monitoring
> + **Link**: [Prometheus and Monitoring Deployment Guide](https://github.com/openimsdk/open-im-server/blob/main/docs/contrib/prometheus-grafana.md)


---

### ğŸ”§ æ›´å¤šç¯å¢ƒå˜é‡

æƒ³äº†è§£æ›´å¤šå…³äºç¯å¢ƒå˜é‡çš„ç»†èŠ‚ï¼Œæ¨èé˜…è¯» [æ­¤æ–‡æ¡£](https://github.com/openimsdk/open-im-server/blob/main/docs/contrib/environment.md)ã€‚

> ğŸš€ **Tip**: å½“ä½ ä½¿ç”¨ `export` å‘½ä»¤è®¾ç½®ç¯å¢ƒå˜é‡æ—¶ï¼Œå®ƒçš„ä¼˜å…ˆçº§ä¼šé«˜äºåœ¨è„šæœ¬ä¸­å®šä¹‰çš„å˜é‡ã€‚

---


### 3. éƒ¨ç½²ç»„ä»¶

```bash
make init && docker compose up -d
```

### 4. æŸ¥çœ‹ç»„ä»¶çŠ¶æ€

```bash
docker ps
```
![components](./assets/components.png)

## äºŒã€OpenIMServer

1. ç¼–è¯‘

```bash
./scripts/build-all-service.sh
```

2. å¯åŠ¨

```bash
./scripts/start-all.sh
```

3. æ£€æµ‹

```bash
./scripts/check-all.sh
```

![im](./assets/im.png)

4. åœæ­¢

```bash
./scripts/stop-all.sh
```

### å¸¸è§é—®é¢˜

#### 1. å¦‚ä½•ä½¿ç”¨å¤–éƒ¨ç»„ä»¶ï¼Ÿ

è¦ä½¿ç”¨æŸäº›å¤–éƒ¨ç»„ä»¶ï¼Œå¦‚å¤–éƒ¨çš„ MySQLï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š

1. ç¼–è¾‘ `docker-compose.yml` æ–‡ä»¶ï¼Œå¹¶æ³¨é‡Šæ‰ MySQL ç›¸å…³çš„é…ç½®ã€‚
2. ç¼–è¾‘ `scripts/install/environment.sh` æ–‡ä»¶ï¼Œç„¶åä¿®æ”¹ MySQL çš„ IPã€ç«¯å£å’Œå¯†ç ç­‰é…ç½®ä¿¡æ¯ã€‚
3. æ‰§è¡Œ `make init` å‘½ä»¤ï¼Œåº”ç”¨æ›´æ”¹ã€‚
4. è¿è¡Œ `docker-compose up -d` å‘½ä»¤ä»¥å¯åŠ¨ç»„ä»¶ã€‚

#### 2. å¯åŠ¨é¡ºåº

å¯åŠ¨é¡ºåºå¦‚ä¸‹ï¼š

- å­˜å‚¨ç›¸å…³çš„ç»„ä»¶
- open-im-server
- chat

#### 3. Docker ç‰ˆæœ¬

æ–°ç‰ˆæœ¬çš„ Docker å·²ç»å°† `docker-compose` é›†æˆä¸ºå…¶æ ¸å¿ƒåŠŸèƒ½ã€‚æ‰€ä»¥ï¼Œæ‚¨ä¸éœ€è¦å•ç‹¬å®‰è£… `docker-compose`ã€‚å¦‚æœæ‚¨çš„ Docker ç‰ˆæœ¬è¿‡ä½ï¼Œè¯·è€ƒè™‘å‡çº§ã€‚å®˜æ–¹æ¨èçš„ç‰ˆæœ¬æ˜¯ `23.0.1`ã€‚

#### 4. å‡çº§é—®é¢˜

å¦‚æœç»„ä»¶çš„è´¦å·å¯†ç ä¿æŒä¸å˜ï¼Œæ‚¨å¯ä»¥ç›´æ¥å‡çº§ã€‚ä½†åœ¨å‡çº§ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²åœæ­¢æ‰€æœ‰è¿›ç¨‹ã€‚

#### 5. ä¿®æ”¹ç»„ä»¶å¯†ç 

å¦‚éœ€åœ¨ç»„ä»¶å¯åŠ¨åä¿®æ”¹å¯†ç ï¼š

1. åœæ­¢ç»„ä»¶çš„ dockerã€‚
2. å¦‚æ•°æ®ä¸é‡è¦ï¼Œæ‚¨å¯ä»¥åˆ é™¤æ•´ä¸ª `components` ç›®å½•ã€‚
3. è®¾ç½®æ–°å¯†ç ï¼š`export PASSWORD=newpassword`ã€‚
4. å¯åŠ¨ç»„ä»¶çš„ docker ä½¿æ–°å¯†ç ç”Ÿæ•ˆã€‚

#### 6. æ›´å¤šé…ç½®é¡¹

è¯·é¿å…ç›´æ¥ä¿®æ”¹ `config/config.yaml` æ–‡ä»¶ã€‚æ¨èé˜…è¯» [æ­¤æ–‡æ¡£](https://github.com/openimsdk/open-im-server/blob/main/docs/contrib/environment.md)ã€‚

#### 7. æ—¥å¿—æŸ¥çœ‹

æ—¥å¿—ä½ç½®å¦‚ä¸‹ï¼š

- è¿è¡Œæ—¶æ—¥å¿—ï¼š`logs/OpenIM.log.all.*`
- å¯åŠ¨æ—¥å¿—ï¼š`_output/logs/openim_*.log`



## ä¸‰ã€AppServer(chat)

1. cloneä»“åº“å¹¶åˆ‡æ¢å‘è¡Œåˆ†æ”¯ï¼ˆrelease-v1.3åŠä¹‹åçš„ç‰ˆæœ¬ï¼‰

```bash
cd .. 
git clone https://github.com/openimsdk/chat.git && cd chat
```

2. ç¼–è¯‘

```bash
./scripts/build_all_service.sh
```

3. å¯åŠ¨

```bash
./scripts/start_all.sh
```

4. æ£€æµ‹

```bash
./scripts/check_all.sh --print-screen
```

![chat](./assets/chat.png)

5. åœæ­¢

```bash
./scripts/stop_all.sh
```

### å¸¸è§é—®é¢˜

---

#### 1. å¦‚æœ zk è¿æ¥å¤±è´¥

è¯·ç¡®ä¿ `zookeeper` çš„ IP å’Œç«¯å£é…ç½®æ­£ç¡®ã€‚å¦‚æœæ‚¨åœ¨ç»„ä»¶éƒ¨ç½²æ—¶æ›´æ”¹äº† `zookeeper` çš„é…ç½®ï¼Œæ‚¨åº”è¯¥åœ¨ `config/config.yaml` æ–‡ä»¶ä¸­ä¿®æ”¹å¯¹åº”çš„ `zookeeper` é…ç½®é¡¹ã€‚

---

#### 2. å¦‚æœç”¨æˆ·æ³¨å†Œå¤±è´¥

é¦–å…ˆï¼Œç¡®è®¤ `openIMUrl` çš„ IP å’Œç«¯å£é…ç½®æ­£ç¡®ã€‚å¦‚æœæ‚¨åœ¨éƒ¨ç½²ç»„ä»¶æ—¶ä¿®æ”¹äº† `OpenIMServer` çš„ IP æˆ–ç«¯å£ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦åœ¨ `config/config.yaml` æ–‡ä»¶ä¸­æ›´æ”¹ç›¸åº”çš„ `openIMUrl` é…ç½®é¡¹ï¼Œè¿™æ · `chat` æ‰èƒ½è®¿é—® `OpenIMServer`

---

#### 3. æ—¥å¿—æŸ¥çœ‹

æ‰€æœ‰æ—¥å¿—æ–‡ä»¶éƒ½å­˜æ”¾åœ¨ `logs` ç›®å½•ä¸‹ï¼š

- `openIM.log`ï¼šè®°å½•å¯åŠ¨æ—¥å¿—ã€‚
- `chat.log.*`ï¼šè®°å½•è¿è¡Œæ—¶çš„æ—¥å¿—ã€‚

---

## å››ã€å¿«é€ŸéªŒè¯

è¦è¿›è¡Œå¿«é€ŸéªŒè¯ï¼Œè¯·å‚è€ƒ [å¿«é€ŸéªŒè¯](./quickTestServer) æ–‡æ¡£ã€‚
